
$msRoot.createNS("ColorPicker");$msRoot.ColorPicker=(function(f){var b=[];var e=0;var d={imgPath:$ms.STATIC_JS_COMMON+"/colorpicker/img",startMode:"h",startColor:"",startPos:undefined,target:undefined,fontSize:75,zIndex:1000,container:undefined,cbClose:undefined,cbChange:undefined,cbCreate:undefined,pin:false,startPinned:false,allowGradient:true,gradient:undefined,fromGradient:false,minimal:false};var a=[{file:"localdata.min.js",ns:"LocalData"},{file:"localfile.min.js",ns:"LocalFile"},{file:"editable-combo.min.js",ns:"EditableCombo"},{file:"custom-dialog.min.js",ns:"CustomDialog"},{file:"dragdrop.min.js",ns:"DragDrop"},{file:"slider.min.js",ns:"Slider"},{file:"colorlibrary.min.js",ns:"ColorPicker.ColorLibrary",subDir:"colorpicker"},{file:"colormethods.min.js",ns:"ColorPicker.Color",subDir:"colorpicker"},{file:"colorvaluepicker.min.js",ns:"ColorPicker.ColorValuePicker",subDir:"colorpicker"},{file:"map-hue.png",baseDir:"js",subDir:"colorpicker/img",id:"cp-map-hue-png",dependencies:[{file:$ms.sourceFiles.onloadTest}]}];$ms.sourceFiles.add(a);$ms.sourceFiles.load();c.getInstance=function(h){if(typeof h!=="undefined"){for(var g=0;g<b.length;g++){if(b[g].id==h){return b[g]}}}else{return b}};function c(j){var l=this;this.keyupFn=function(i){this.keyup(i)}.bind(this);b.push(this);this.id="ms-colorpicker-"+e+++"-";this.colorMap;this.colorBar;this.opacitySlider;this.cpLibrary;this.previewOrigSet=false;this.isPinned=false;this.settings=$ms.cloneSettings(d,j);if(this.settings.imgPath.length>0&&this.settings.imgPath.substr(-1)!=="/"){this.settings.imgPath+="/"}if(!this.settings.container){this.settings.container=document.body}var j={cbSetColor:function(i){this.setColor(i)}.bind(this),saveLabel:"Save Color",libSuffix:"cp",valueToSet:"rgbString",cbResize:function(i){if(i=="open"){$ms.addClass($ms.$(this+"name-label"),"display-none")}else{$ms.removeClass($ms.$(this+"name-label"),"display-none")}}.bind(this)};this.cpLibrary=new $msRoot.ColorPicker.ColorLibrary(j);this.container=this.createForm();$ms.draggable(this.container,{scope:"default",handle:this.id+"title-bar",cbDrop:this.drop.bind(this)});if(this.settings.startPinned&&this.settings.gradient){this.pinToGradient()}else{if(this.settings.startPos){this.settings.startPos.top=parseFloat(this.settings.startPos.top)+"px";this.settings.startPos.left=parseFloat(this.settings.startPos.left)+"px"}else{if(this.settings.source){var p=$ms.getOffset(this.settings.source);this.settings.startPos={};this.settings.startPos.top=p.top+p.height+"px";this.settings.startPos.left=p.left+(20+b.length)+"px"}else{this.settings.startPos={top:100+(20*b.length)+"px",left:100+(20*b.length)+"px"}}}}var s=$ms.windowSize();var q=parseInt($ms.getPropertyValue(this.container,"width"));var r=parseInt($ms.getPropertyValue(this.container,"height"));this.container.style.top=Math.max(0,parseInt(this.settings.startPos.top))+"px";this.container.style.left=Math.max(0,parseInt(this.settings.startPos.left))+"px";this.hueRadio=$ms.$(this.id+"hue-radio");this.saturationRadio=$ms.$(this.id+"saturation-radio");this.valueRadio=$ms.$(this.id+"brightness-radio");this.redRadio=$ms.$(this.id+"red-radio");this.greenRadio=$ms.$(this.id+"green-radio");this.blueRadio=$ms.$(this.id+"blue-radio");this.notSetCheck=$ms.$(this.id+"not-set-check");this.opacityInput=$ms.$(this.id+"opacity-input");this.hue2Radio=$ms.$(this.id+"hue2-radio");this.saturation2Radio=$ms.$(this.id+"saturation2-radio");this.lightnessRadio=$ms.$(this.id+"lightness-radio");this.colorNameInput=$ms.$(this.id+"color-name");this.hueRadio.value="h";this.saturationRadio.value="s";this.valueRadio.value="v";this.redRadio.value="r";this.greenRadio.value="g";this.blueRadio.value="b";this.hue2Radio.value="h2";this.saturation2Radio.value="s2";this.lightnessRadio.value="l";this.hueRadio.addEventListener("click",function(i){this.radioClicked(i)}.bind(this));this.saturationRadio.addEventListener("click",function(i){this.radioClicked(i)}.bind(this));this.valueRadio.addEventListener("click",function(i){this.radioClicked(i)}.bind(this));this.redRadio.addEventListener("click",function(i){this.radioClicked(i)}.bind(this));this.greenRadio.addEventListener("click",function(i){this.radioClicked(i)}.bind(this));this.blueRadio.addEventListener("click",function(i){this.radioClicked(i)}.bind(this));this.blueRadio.addEventListener("click",function(i){this.radioClicked(i)}.bind(this));this.hue2Radio.addEventListener("click",function(i){this.radioClicked(i)}.bind(this));this.saturation2Radio.addEventListener("click",function(i){this.radioClicked(i)}.bind(this));this.lightnessRadio.addEventListener("click",function(i){this.radioClicked(i)}.bind(this));this.notSetCheck.addEventListener("click",function(i){this.notSetCheckClicked(i)}.bind(this));window.addEventListener("keyup",l.keyupFn);this.preview=$ms.$(this.id+"preview");this.previewOrig=$ms.$(this.id+"preview-orig");this.cssText=$ms.$(this.id+"css-text");this.cpLibrary.libraryNameCombo.setValue("Default");this.cpLibrary.libraryNameCombo.settings.cbChange({value:"Default"},true);this.mapBase=this.colorMap;this.mapBase.style.width="256px";this.mapBase.style.height="256px";this.mapBase.style.padding=0;this.mapBase.style.margin=0;this.mapBase.style.border="solid 1px #000";this.mapL1=document.createElement("img");this.mapL1.src=this.settings.imgPath+"blank.gif";this.mapL1.width=256;this.mapL1.height=256;this.mapL1.style.margin="0px";this.mapL1.className="ms-no-select";this.mapBase.appendChild(this.mapL1);this.mapL1b=document.createElement("img");this.mapL1b.src=this.settings.imgPath+"blank.gif";this.mapL1b.width=256;this.mapL1b.height=256;this.mapBase.appendChild(this.mapL1b);this.mapL1b.style.clear="both";this.mapL1b.style.margin="-256px 0px 0px 0px";this.mapL1b.style.opacity="0";this.mapL1b.className="ms-no-select";this.mapL2=document.createElement("img");this.mapL2.src=this.settings.imgPath+"blank.gif";this.mapL2.width=256;this.mapL2.height=256;this.mapBase.appendChild(this.mapL2);this.mapL2.style.clear="both";this.mapL2.style.margin="-256px 0px 0px 0px";this.mapL2.style.opacity=".5";this.mapL2.className="ms-no-select";this._bar=this.colorBar;this._bar.style.width="20px";this._bar.style.height="256px";this._bar.style.padding=0;this._bar.style.margin="0px 10px";this._bar.style.border="solid 1px #000";this._bar.className="ms-no-select";this._barL1=document.createElement("img");this._barL1.src=this.settings.imgPath+"blank.gif";this._barL1.width=20;this._barL1.height=256;this._barL1.style.margin="0px";this._bar.appendChild(this._barL1);this._barL2=document.createElement("img");this._barL2.src=this.settings.imgPath+"blank.gif";this._barL2.width=20;this._barL2.height=256;this._barL2.style.margin="-256px 0px 0px 0px";this._bar.appendChild(this._barL2);this._barL3=document.createElement("img");this._barL3.src=this.settings.imgPath+"blank.gif";this._barL3.width=20;this._barL3.height=256;this._barL3.style.margin="-256px 0px 0px 0px";this._barL3.style.backgroundColor="#ff0000";this._bar.appendChild(this._barL3);this._barL4=document.createElement("img");this._barL4.id=this.id+"color-bar-img";this._barL4.src=this.settings.imgPath+"blank.gif";this._barL4.width=20;this._barL4.height=256;this._barL4.style.margin="-256px 0px 0px 0px";this._bar.appendChild(this._barL4);this.cvp=new $msRoot.ColorPicker.ColorValuePicker(this.id);var m=[this.cvp.hexInput,this.cvp.hueInput,this.cvp.saturationInput,this.cvp.valueInput,this.cvp.redInput,this.cvp.greenInput,this.cvp.blueInput,this.hueRadio,this.saturationRadio,this.valueRadio,this.redRadio,this.greenRadio,this.blueRadio];this.map=new $msRoot.Slider(this.mapL2,{xMinValue:0,xMaxValue:255,yMinValue:0,yMaxValue:255,arrowImage:"mappoint.gif",imgPath:this.settings.imgPath,container:this.mapBase,direction:"both",parentNode:this.container,target:m,cbSliderMouseup:function(){this.sliderMouseup()}.bind(this),hideCursor:true,throttle:30});this.slider=new $msRoot.Slider(this._barL4,{xMinValue:1,xMaxValue:1,yMinValue:0,yMaxValue:255,arrowImage:"rangearrows.gif",imgPath:this.settings.imgPath,container:this.colorBar,direction:"vertical",bar2:this._bar,cbSliderMouseup:function(){this.sliderMouseup()}.bind(this)});this.slider.onValuesChanged=function(){this.sliderValueChanged()}.bind(this);this.map.onValuesChanged=function(){this.mapValueChanged()}.bind(this);this.cvp.onValuesChanged=function(){this.textValuesChanged()}.bind(this);this.cvp.onOpacityValuesChanged=function(){this.opacityValuesChanged()}.bind(this);this.isLessThanIE7=false;var n=parseFloat(navigator.appVersion.split("MSIE")[1]);if((n<7)&&(document.body.filters)){this.isLessThanIE7=true}var o;if(this.settings.allowGradient&&this.settings.startColor.indexOf("gradient")!==-1&&!this.settings.fromGradientStartColor){this.openGradient(this.settings.startColor,true);return}if(this.settings.fromGradientStartColor){o=this.settings.fromGradientStartColor}else{o=this.settings.startColor}if(o.indexOf("transparent")!==-1){o="rgba(255,255,255,0)"}o=o.trim();if(o.length>0&&o.substr(0,1)!=="#"&&o.substr(0,3)!=="rgb"){var g=document.createElement("div");g.style.color=o;o=getComputedStyle(g).getPropertyValue("color")}var h=$msRoot.colorMethods.colorInfo(o);this.cvp.hexInput.value=h.hex;this.opacityInput.value=parseInt(h.alpha*100);if(this.opacityInput.value==0){this.opacityInput.style.color="red"}else{this.opacityInput.style.color="black"}if(h.hex==""){this.notSetCheck.checked=true}this.cvp.setValuesFromHex();this.setColorMode(this.settings.startMode);this.positionArrows();this.positionOpacityArrows();this.updateVisuals();if(this.settings.cbCreate){if(Array.isArray(this.settings.cbCreate)){for(var k=0;k<this.settings.cbCreate.length;k++){this.settings.cbCreate[k](this)}}else{this.settings.cbCreate(this)}}}c.prototype.show=function(g){this.container.style.zIndex=g;$ms.removeClass(this.container,"display-none");this.drop(true)};c.prototype.hide=function(){$ms.addClass(this.container,"display-none")};c.prototype.radioClicked=function(g){this.setColorMode(g.target.value)};c.prototype._onWebSafeClicked=function(g){this.setColorMode(this.ColorMode)};c.prototype.textValuesChanged=function(){if(this.cvp.validName==="empty"){this.cssText.innerHTML=this.getCss();this.cssText.title=this.cssText.innerHTML.replace(/<[^>]+>/g,"  ");this.cvp.validName=null;return}else{if(this.cvp.validName===false){this.cssText.innerHTML="<span style='color:red'>Color name not found.</span>";this.cssText.title="";this.cvp.validName=null;return}}this.cvp.setColorName();this.positionArrows();this.updateVisuals();this.updateGradientFromInput()};c.prototype.opacityValuesChanged=function(){this.cvp.setValuesFromOpacity();this.positionOpacityArrows();this.updateVisuals();this.updateGradientFromInput()};c.prototype.notSetCheckClicked=function(){if(this.notSetCheck.checked){this.previousValue=Object.assign({},this.cvp.color);this.previousValue.rgb=this.previousValue.rgb.slice(0);this.previousValue.alpha=this.opacityInput.value/100;this.cvp.hexInput.value="";this.opacityInput.value=100}else{if(!this.previousValue){this.previousValue=$msRoot.colorMethods.colorInfo(this.settings.startColor)}this.cvp.hexInput.value=this.previousValue.hex;this.opacityInput.value=this.previousValue.alpha*100}this.cvp.setValuesFromHex();this.positionArrows();this.positionOpacityArrows();this.updateVisuals();this.updateGradientFromInput()};c.prototype.setColorMode=function(h){var i=this;this.color=this.cvp.color;function g(k,j){k.setAlpha(j,100);j.style.backgroundColor="";j.src=k.settings.imgPath+"blank.gif";j.style.filter=""}g(this,this.mapL1);g(this,this.mapL1b);g(this,this.mapL2);g(this,this._barL1);g(this,this._barL2);g(this,this._barL3);g(this,this._barL4);this.hueRadio.checked=false;this.saturationRadio.checked=false;this.valueRadio.checked=false;this.redRadio.checked=false;this.greenRadio.checked=false;this.blueRadio.checked=false;this.hue2Radio.checked=false;this.saturation2Radio.checked=false;this.lightnessRadio.checked=false;switch(h){case"h":this.hueRadio.checked=true;this.mapL1.style.backgroundColor=this.color.hex;this.mapL2.style.backgroundColor="transparent";this.setImg(this.mapL2,this.settings.imgPath+"map-hue.png");this.setAlpha(this.mapL2,100);this.setImg(this._barL4,this.settings.imgPath+"bar-hue.png");this.map.settings.xMaxValue=100;this.map.settings.yMaxValue=100;this.slider.settings.yMaxValue=360;break;case"s":this.saturationRadio.checked=true;this.setImg(this.mapL1,this.settings.imgPath+"map-saturation.png");this.setImg(this.mapL2,this.settings.imgPath+"map-saturation-overlay.png");this.setAlpha(this.mapL2,0);this.setBG(this._barL3,this.color.hex);this.setImg(this._barL4,this.settings.imgPath+"bar-saturation.png");this.map.settings.xMaxValue=360;this.map.settings.yMaxValue=100;this.slider.settings.yMaxValue=100;break;case"v":this.valueRadio.checked=true;this.setBG(this.mapL1,"000");this.setImg(this.mapL2,this.settings.imgPath+"map-brightness.png");this._barL3.style.backgroundColor=this.color.hex;this.setImg(this._barL4,this.settings.imgPath+"bar-brightness.png");this.map.settings.xMaxValue=360;this.map.settings.yMaxValue=100;this.slider.settings.yMaxValue=100;break;case"r":this.redRadio.checked=true;this.setImg(this.mapL2,this.settings.imgPath+"map-red-max.png");this.setImg(this.mapL1,this.settings.imgPath+"map-red-min.png");this.setImg(this._barL4,this.settings.imgPath+"bar-red-tl.png");this.setImg(this._barL3,this.settings.imgPath+"bar-red-tr.png");this.setImg(this._barL2,this.settings.imgPath+"bar-red-br.png");this.setImg(this._barL1,this.settings.imgPath+"bar-red-bl.png");break;case"g":this.greenRadio.checked=true;this.setImg(this.mapL2,this.settings.imgPath+"map-green-max.png");this.setImg(this.mapL1,this.settings.imgPath+"map-green-min.png");this.setImg(this._barL4,this.settings.imgPath+"bar-green-tl.png");this.setImg(this._barL3,this.settings.imgPath+"bar-green-tr.png");this.setImg(this._barL2,this.settings.imgPath+"bar-green-br.png");this.setImg(this._barL1,this.settings.imgPath+"bar-green-bl.png");break;case"b":this.blueRadio.checked=true;this.setImg(this.mapL2,this.settings.imgPath+"map-blue-max.png");this.setImg(this.mapL1,this.settings.imgPath+"map-blue-min.png");this.setImg(this._barL4,this.settings.imgPath+"bar-blue-tl.png");this.setImg(this._barL3,this.settings.imgPath+"bar-blue-tr.png");this.setImg(this._barL2,this.settings.imgPath+"bar-blue-br.png");this.setImg(this._barL1,this.settings.imgPath+"bar-blue-bl.png");break;case"h2":this.hue2Radio.checked=true;this.mapL1.style.backgroundColor=this.color.hex;this.mapL2.style.backgroundColor="transparent";this.setImg(this.mapL2,this.settings.imgPath+"map-hsl-hue.png");this.setAlpha(this.mapL2,100);this.setImg(this._barL4,this.settings.imgPath+"bar-hue.png");this.map.settings.xMaxValue=100;this.map.settings.yMaxValue=100;this.slider.settings.yMaxValue=360;break;case"s2":this.saturation2Radio.checked=true;this.setImg(this.mapL1,this.settings.imgPath+"map-hsl-saturation.png");this.setAlpha(this.mapL2,99);this.setBG(this.map1b,"rgb(128,128,128)");this.setAlpha(this.mapL1b,0);this.setImg(this.mapL2,this.settings.imgPath+"map-hsl-saturation-overlay.png");this.setBG(this._barL3,this.color.hex);this.setImg(this._barL4,this.settings.imgPath+"bar-saturation.png");this.map.settings.xMaxValue=360;this.map.settings.yMaxValue=100;this.slider.settings.yMaxValue=100;break;case"l":this.lightnessRadio.checked=true;this.setImg(this.mapL1,this.settings.imgPath+"map-hsl-lightness.png");this.setBG(this.mapL2,"rgb(255,255,255)");this.setAlpha(this.mapL2,0);this._barL3.style.backgroundColor=this.color.hex;this.setImg(this._barL4,this.settings.imgPath+"bar-brightness.png");this.map.settings.xMaxValue=360;this.map.settings.yMaxValue=100;this.slider.settings.yMaxValue=100;break;default:alert("invalid mode");break}switch(h){case"h":case"s":case"v":this.map.settings.xMinValue=0;this.map.settings.yMinValue=0;this.slider.settings.yMinValue=0;break;case"r":case"g":case"b":this.map.settings.xMinValue=0;this.map.settings.yMinValue=0;this.slider.settings.yMinValue=0;this.map.settings.xMaxValue=255;this.map.settings.yMaxValue=255;this.slider.settings.yMaxValue=255;break;case"h2":case"s2":case"l":this.map.settings.xMinValue=0;this.map.settings.yMinValue=0;this.slider.settings.yMinValue=0;break}this.ColorMode=h;this.positionArrows();this.updateMapVisuals();this.updateSliderVisuals()};c.prototype.mapValueChanged=function(){switch(this.ColorMode){case"h":this.cvp.saturationInput.value=$ms.round(this.map.xValue);this.cvp.valueInput.value=$ms.round(100-this.map.yValue);break;case"s":this.cvp.hueInput.value=$ms.round(this.map.xValue);this.cvp.valueInput.value=$ms.round(100-this.map.yValue);break;case"v":this.cvp.hueInput.value=$ms.round(this.map.xValue);this.cvp.saturationInput.value=$ms.round(100-this.map.yValue);break;case"r":this.cvp.blueInput.value=$ms.round(this.map.xValue);this.cvp.greenInput.value=$ms.round(256-this.map.yValue);break;case"g":this.cvp.blueInput.value=$ms.round(this.map.xValue);this.cvp.redInput.value=$ms.round(256-this.map.yValue);break;case"b":this.cvp.redInput.value=$ms.round(this.map.xValue);this.cvp.greenInput.value=$ms.round(256-this.map.yValue);break;case"h2":this.cvp.saturation2Input.value=$ms.round(this.map.xValue);this.cvp.lightnessInput.value=$ms.round(100-this.map.yValue);break;case"s2":this.cvp.hue2Input.value=$ms.round(this.map.xValue);this.cvp.lightnessInput.value=$ms.round(100-this.map.yValue);break;case"l":this.cvp.hue2Input.value=$ms.round(this.map.xValue);this.cvp.saturation2Input.value=$ms.round(100-this.map.yValue);break}switch(this.ColorMode){case"h":case"s":case"v":this.cvp.setValuesFromHsv();break;case"r":case"g":case"b":this.cvp.setValuesFromRgb();break;case"h2":case"s2":case"l":this.cvp.setValuesFromHsl();break}this.updateVisuals();this.updateGradientFromInput()};c.prototype.sliderValueChanged=function(){switch(this.ColorMode){case"h":this.cvp.hueInput.value=Math.round(360-this.slider.yValue);if(this.cvp.hueInput.value==360){this.cvp.hueInput.value=0}break;case"s":this.cvp.saturationInput.value=Math.round(100-this.slider.yValue);break;case"v":this.cvp.valueInput.value=Math.round(100-this.slider.yValue);break;case"r":this.cvp.redInput.value=Math.round(255-this.slider.yValue);break;case"g":this.cvp.greenInput.value=Math.round(255-this.slider.yValue);break;case"b":this.cvp.blueInput.value=Math.round(255-this.slider.yValue);break;case"h2":this.cvp.hue2Input.value=Math.round(360-this.slider.yValue);if(this.cvp.hue2Input.value==360){this.cvp.hue2Input.value=0}break;case"s2":this.cvp.saturation2Input.value=Math.round(100-this.slider.yValue);break;case"l":this.cvp.lightnessInput.value=Math.round(100-this.slider.yValue);break}switch(this.ColorMode){case"h":case"s":case"v":this.cvp.setValuesFromHsv();break;case"r":case"g":case"b":this.cvp.setValuesFromRgb();break;case"h2":case"s2":case"l":this.cvp.setValuesFromHsl();break}this.updateVisuals();this.updateGradientFromInput()};c.prototype.opacitySliderValueChanged=function(){this.opacityInput.value=parseInt(this.opacitySlider.xValue);this.cvp.setValuesFromOpacity();this.updateVisuals();this.updateGradientFromInput()};c.prototype.positionArrows=function(){this.color=this.cvp.color;var h=0;switch(this.ColorMode){case"h":h=360-this.color.h;break;case"s":h=100-this.color.s;break;case"v":h=100-this.color.v;break;case"r":h=255-this.color.r;break;case"g":h=255-this.color.g;break;case"b":h=255-this.color.b;break;case"h2":h=360-this.color.h2;break;case"s2":h=100-this.color.s2;break;case"l":h=100-this.color.l;break}this.slider.yValue=h;this.slider.setArrowPositionFromValues();var g=0;var i=0;switch(this.ColorMode){case"h":g=this.color.s;i=100-this.color.v;break;case"s":g=this.color.h;i=100-this.color.v;break;case"v":g=this.color.h;i=100-this.color.s;break;case"r":g=this.color.b;i=256-this.color.g;break;case"g":g=this.color.b;i=256-this.color.r;break;case"b":g=this.color.r;i=256-this.color.g;break;case"h2":g=this.color.s2;i=100-this.color.l;break;case"s2":g=this.color.h2;i=100-this.color.l;break;case"l":g=this.color.h2;i=100-this.color.s2;break}this.map.xValue=g;this.map.yValue=i;this.map.setArrowPositionFromValues()};c.prototype.positionOpacityArrows=function(){this.opacitySlider.xValue=parseInt(this.opacityInput.value);this.opacitySlider.setArrowPositionFromValues()};c.prototype.updateVisuals=function(g){this.updatePreview();this.updateMapVisuals();this.updateSliderVisuals();this.updateTarget();this.cpLibrary.color=this.cvp.color;this.cssText.innerHTML=this.getCss();this.cssText.title=this.cssText.innerHTML.replace(/<[^>]+>/g,"  ");if(g){return}if(this.settings.gradient){this.settings.gradient.updateVisuals()}};c.prototype.updateTarget=function(j){if(!this.settings.target){return}if(this.settings.gradient){return}try{for(var h=0;h<this.settings.target.length;h++){var m=this.settings.target[h];if(typeof m.property=="undefined"){continue}if(m.property){var k;if(m.property=="backgroundImage"){k="background"}else{k=m.property}m.element.style[k]=this.cvp.color.rgbString}if(m.valueAttribute){m.element[m.valueAttribute]=this.cvp.color.rgbString;var g;if(m.textColor=="contrast"){g=$msRoot.colorMethods.highlightcolor(this.cvp.redInput.value,this.cvp.greenInput.value,this.cvp.blueInput.value)}else{g=this.cvp.color.rgbString}m.element.style.color=g}}if(typeof this.settings.cbChange!=="undefined"){this.settings.cbChange(this,this.cvp.color)}}catch(l){console.log("ColorPicker.updateTarget: "+l.message)}};c.prototype.updatePreview=function(){try{if(this.cvp.color.hex.length==0){this.notSetCheck.checked=true;this.preview.style.removeProperty("background-color")}else{this.notSetCheck.checked=false;this.preview.style.backgroundColor=this.cvp.color.rgbString}if(!this.previewOrigSet){this.previewOrigSet=true;this.previewOrig.style.backgroundColor=this.preview.style.backgroundColor}if(this.opacityInput.value==0){this.opacityInput.style.color="red"}else{this.opacityInput.style.color="black"}}catch(g){}};c.prototype.updateMapVisuals=function(){this.color=this.cvp.color;switch(this.ColorMode){case"h":var g=new $msRoot.ColorPicker.Color({h:this.color.h,s:100,v:100});this.setBG(this.mapL1,g.hex);break;case"s":this.setAlpha(this.mapL2,100-this.color.s);break;case"v":this.setAlpha(this.mapL2,this.color.v);break;case"r":this.setAlpha(this.mapL2,this.color.r/256*100);break;case"g":this.setAlpha(this.mapL2,this.color.g/256*100);break;case"b":this.setAlpha(this.mapL2,this.color.b/256*100);break;case"h2":var g=new $msRoot.ColorPicker.Color({h2:this.color.h2,s2:100,l:50});this.setBG(this.mapL1,g.hex);break;case"s2":this.setBG(this.mapL1b,"rgb(128,128,128)");this.setAlpha(this.mapL1b,Math.min(99,100-this.color.s2));break;case"l":if(this.color.l>50){this.setBG(this.mapL2,"white")}else{this.setBG(this.mapL2,"black")}this.setAlpha(this.mapL2,Math.min(99,Math.abs(this.color.l-50)*2));break}};c.prototype.updateSliderVisuals=function(){this.color=this.cvp.color;switch(this.ColorMode){case"h":break;case"s":var g=new $msRoot.ColorPicker.Color({h:this.color.h,s:100,v:this.color.v});this.setBG(this._barL3,g.hex);break;case"v":var k=new $msRoot.ColorPicker.Color({h:this.color.h,s:this.color.s,v:100});this.setBG(this._barL3,k.hex);break;case"r":case"g":case"b":var n=0;var i=0;if(this.ColorMode=="r"){n=this.cvp.blueInput.value;i=this.cvp.greenInput.value}else{if(this.ColorMode=="g"){n=this.cvp.blueInput.value;i=this.cvp.redInput.value}else{if(this.ColorMode=="b"){n=this.cvp.redInput.value;i=this.cvp.greenInput.value}}}var h=(n/256)*100;var j=(i/256)*100;var m=((256-n)/256)*100;var l=((256-i)/256)*100;this.setAlpha(this._barL4,(j>m)?m:j);this.setAlpha(this._barL3,(j>h)?h:j);this.setAlpha(this._barL2,(l>h)?h:l);this.setAlpha(this._barL1,(l>m)?m:l);break;case"h2":break;case"s2":var g=new $msRoot.ColorPicker.Color({h:this.color.h2,s:100,v:this.color.l});this.setBG(this._barL3,g.hex);break;case"l":var k=new $msRoot.ColorPicker.Color({h2:this.color.h2,s2:this.color.s2,l:50});this.setBG(this._barL3,k.hex);break}};c.prototype.setBG=function(g,i){try{g.style.backgroundColor=i}catch(h){}};c.prototype.setImg=function(g,h){if(h.indexOf("png")&&this.isLessThanIE7){g.pngSrc=h;g.src=this.settings.imgPath+"blank.gif";g.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+h+"');"}else{g.src=h}};c.prototype.setAlpha=function(h,g){if(this.isLessThanIE7){var i=h.pngSrc;if(i!=null&&i.indexOf("map-hue")==-1&&i.indexOf("map-hsl-hue")==-1){h.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+i+"') progid:DXImageTransform.Microsoft.Alpha(opacity="+g+")"}}else{h.style.opacity=(g/100)}};c.prototype.save=function(){if(this.settings.gradient){this.hide()}else{this.close()}};c.prototype.cancel=function(g){if(this.settings.allowGradient&&this.settings.startColor.indexOf("gradient")!==-1){this.openGradient()}else{this.setColor(this.settings.startColor)}if(this.settings.gradient){this.hide()}else{this.close()}};c.prototype.close=function(){window.removeEventListener("keyup",this.keyupFn);if(this.container.parentNode){this.container.parentNode.removeChild(this.container)}for(var g=0;g<b.length;g++){if(b[g].id==this.id){b.splice(g,1);break}}this.map.close();this.slider.close();this.opacitySlider.close();this.cpLibrary.close();$msRoot.CustomDialog.closeDialogs(this.id);if(this.settings.cbClose){if(Array.isArray(this.settings.cbClose)){for(var g=0;g<this.settings.cbClose.length;g++){this.settings.cbClose[g](this)}}else{this.settings.cbClose(this)}}};c.prototype.bringToFront=function(){var g=0;if(!$msRoot.Gradient){return}for(var h=0;h<b.length;h++){if(b.id!==this.id){g=Math.max(g,parseInt(b[h].container.style.zIndex))}}var j=$msRoot.Gradient.getInstance();for(var h=0;h<j.length;h++){g=Math.max(g,parseInt(j[h].container.style.zIndex))}this.container.style.zIndex=Math.max(parseInt(this.container.style.zIndex),g+1)};c.prototype.createForm=function(){var y=this;var j,q,v,u,r;var n=document.createElement("div");n.id=this.id+"container";n.className="ms-colorpicker draggable";n.style.zIndex=this.settings.zIndex+b.length;var x=document.createElement("div");x.id=this.id+"title-bar";x.className="ms-title-bar";x.style.height="20px";x.style.lineHeight="20px";x.style.textAlign="center";x.addEventListener("mousedown",function(){this.bringToFront()}.bind(this));n.appendChild(x);var G=new $msRoot.LocalData();var F=G.getProperty("colorpicker","pin");if(this.settings.pin||F){var v=document.createElement("div");v.id=this.id+"pin-button";if((this.settings.startPinned||F)&&this.settings.gradient){this.isPinned=true;v.className="ms-pinned-button"}else{v.className="ms-unpinned-button"}v.addEventListener("click",function(){this.pin()}.bind(this));x.appendChild(v)}var v=$ms.createCloseButton(this.id,function(){if(this.settings.gradient){this.hide()}else{this.close()}}.bind(this));x.appendChild(v);if(this.settings.pin){var v=document.createElement("div");v.id=this.id+"pin-button";v.className="ms-pin-button display-none";v.addEventListener("click",function(){this.pin(true)}.bind(this));x.appendChild(v);var v=document.createElement("div");v.id=this.id+"unpin-button";v.className="ms-unpin-button";v.addEventListener("click",function(){this.pin()}.bind(this));x.appendChild(v)}var B=document.createElement("table");B.style.display="inline-block";B.style.verticalAlign="top";var E=[45,200];var s=document.createElement("colgroup");B.appendChild(s);for(var A=0;A<E.length;A++){var l=document.createElement("col");s.appendChild(l);l.style.width=E[A]+"px"}var D=document.createElement("tr");var q=document.createElement("td");q.colSpan="2";q.style.verticalAlign="top";D.appendChild(q);this.colorMap=document.createElement("div");q.appendChild(this.colorMap);q=document.createElement("td");q.style.verticalAlign="top";D.appendChild(q);B.appendChild(D);this.colorBar=document.createElement("div");q.appendChild(this.colorBar);j=document.createElement("tr");q=document.createElement("td");q.colSpan="2";u=document.createElement("input");u.type="checkbox";u.style.verticalAlign="middle";u.id=this.id+"not-set-check";q.appendChild(u);r=document.createElement("label");r.htmlFor=this.id+"not-set-check";r.innerText="Not Set";r.style.marginLeft="5px";q.appendChild(r);j.appendChild(q);B.appendChild(j);j=document.createElement("tr");q=document.createElement("td");r=document.createElement("label");r.htmlFor=this.id+"opacity";r.className="ms-cp-label";q.appendChild(r);q.innerHTML="Opacity";j.appendChild(q);q=document.createElement("td");var C={min:0,max:100,snapX:1,sliderWidth:145,inputWidth:35,inputId:this.id+"opacity-input",textAfterInput:" %",sliderInput:true,parentNode:q,imgPath:this.settings.imgPath};this.opacitySlider=new $msRoot.Slider(undefined,C);this.opacitySlider.onValuesChanged=function(){y.opacitySliderValueChanged()};j.appendChild(q);B.appendChild(j);j=document.createElement("tr");q=document.createElement("td");q.colSpan="3";var o=document.createElement("div");o.className="ms-cp-css";q.appendChild(o);j.appendChild(q);B.appendChild(j);var p=document.createElement("div");p.id=this.id+"css-text";p.className="ms-cp-css-text";o.appendChild(p);var w=document.createElement("div");w.innerHTML="Copy";w.className="ms-gradient-button ms-cp-copy-button";w.addEventListener("click",function(i){var I=p.innerHTML.replace(/<[^>]+>/g,"\n").replace(/\n\s*\n/g,"\n");$ms.copyToClipboard(I);$ms.removeClass($ms.$(this.id+"copy-status"),"display-none");setTimeout(function(){$ms.addClass($ms.$(this.id+"copy-status"),"display-none")}.bind(this),1000)}.bind(this));o.appendChild(w);var h=document.createElement("div");h.id=this.id+"copy-status";h.className="ms-gradient-copy-status display-none";h.innerHTML="Copied to Clipboard";o.appendChild(h);var z=document.createElement("table");z.style.display="inline-block";z.style.verticalAlign="top";var E=[20,12,45];var s=document.createElement("colgroup");z.appendChild(s);for(var A=0;A<E.length;A++){var l=document.createElement("col");s.appendChild(l);l.style.width=E[A]+"px"}j=document.createElement("tr");q=document.createElement("td");q.colSpan="3";v=document.createElement("div");v.style.width="80px";v.style.marginTop="5px";v.style.textAlign="center";v.innerHTML="New";q.appendChild(v);var t=document.createElement("div");t.style.width="80px";t.style.height="32px";t.style.borderTop="solid 1px #000";t.style.borderRight="solid 1px #000";t.style.borderLeft="solid 1px #000";t.className="ms-cp-transparent-grid";q.appendChild(t);v=document.createElement("div");v.id=this.id+"preview";v.style.width="100%";v.style.height="100%";t.appendChild(v);var t=document.createElement("div");t.style.width="80px";t.style.height="32px";t.style.borderBottom="solid 1px #000";t.style.borderRight="solid 1px #000";t.style.borderLeft="solid 1px #000";t.className="ms-cp-transparent-grid";t.addEventListener("click",function(){this.cvp.hexInput.value=$msRoot.colorMethods.colorInfo(this.settings.startColor).hex;this.opacityInput.value=parseInt($msRoot.colorMethods.colorInfo(this.settings.startColor).alpha*100);this.cvp.setValuesFromHex();this.positionArrows();this.updateVisuals()}.bind(this));q.appendChild(t);v=document.createElement("div");v.id=this.id+"preview-orig";v.style.width="100%";v.style.height="100%";t.appendChild(v);v=document.createElement("div");v.style.width="80px";v.style.textAlign="center";v.style.marginBottom="5px";v.innerHTML="Original";q.appendChild(v);j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");u=document.createElement("input");u.type="radio";u.id=this.id+"hue-radio";u.value="h";q.appendChild(u);j.appendChild(q);q=document.createElement("td");r=document.createElement("label");r.htmlFor=this.id+"hue-radio";r.innerText="H:";q.appendChild(r);j.appendChild(q);q=document.createElement("td");u=document.createElement("input");u.type="text";u.id=this.id+"hue-input";u.value="0";u.style.width="40px";q.appendChild(u);q.appendChild(document.createTextNode(" \xB0"));q.style.whiteSpace="nowrap";j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");u=document.createElement("input");u.type="radio";u.id=this.id+"saturation-radio";u.value="s";q.appendChild(u);j.appendChild(q);q=document.createElement("td");r=document.createElement("label");r.htmlFor=this.id+"saturation-radio";r.innerText="S:";q.appendChild(r);j.appendChild(q);q=document.createElement("td");u=document.createElement("input");u.type="text";u.id=this.id+"saturation-input";u.value="100";u.style.width="40px";q.appendChild(u);q.appendChild(document.createTextNode(" %"));q.style.whiteSpace="nowrap";j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");u=document.createElement("input");u.type="radio";u.id=this.id+"brightness-radio";u.value="v";q.appendChild(u);j.appendChild(q);q=document.createElement("td");r=document.createElement("label");r.htmlFor=this.id+"brightness-radio";r.innerText="B:";q.appendChild(r);j.appendChild(q);q=document.createElement("td");u=document.createElement("input");u.type="text";u.id=this.id+"brightness-input";u.value="100";u.style.width="40px";q.appendChild(u);q.appendChild(document.createTextNode(" %"));q.style.whiteSpace="nowrap";j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");q.colSpan="3";q.style.height="5px";j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");u=document.createElement("input");u.type="radio";u.id=this.id+"red-radio";u.value="r";q.appendChild(u);j.appendChild(q);z.appendChild(j);q=document.createElement("td");r=document.createElement("label");r.htmlFor=this.id+"red-radio";q.appendChild(r);q.innerHTML="R:";j.appendChild(q);q=document.createElement("td");u=document.createElement("input");u.type="text";u.id=this.id+"red-input";u.value="255";u.style.width="40px";q.appendChild(u);j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");u=document.createElement("input");u.type="radio";u.id=this.id+"green-radio";u.value="g";q.appendChild(u);j.appendChild(q);q=document.createElement("td");r=document.createElement("label");r.htmlFor=this.id+"green-radio";q.appendChild(r);q.innerHTML="G:";j.appendChild(q);q=document.createElement("td");u=document.createElement("input");u.type="text";u.id=this.id+"green-input";u.value="0";u.style.width="40px";q.appendChild(u);j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");u=document.createElement("input");u.type="radio";u.id=this.id+"blue-radio";u.value="b";q.appendChild(u);j.appendChild(q);q=document.createElement("td");r=document.createElement("label");r.htmlFor=this.id+"blue-radio";q.appendChild(r);q.innerHTML="B:";j.appendChild(q);q=document.createElement("td");u=document.createElement("input");u.type="text";u.id=this.id+"blue-input";u.value="0";u.style.width="40px";q.appendChild(u);j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");q.colSpan="3";q.style.height="5px";j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");u=document.createElement("input");u.type="radio";u.id=this.id+"hue2-radio";u.value="h2";q.appendChild(u);j.appendChild(q);q=document.createElement("td");r=document.createElement("label");r.htmlFor=this.id+"hue2-radio";r.innerText="H:";q.appendChild(r);j.appendChild(q);q=document.createElement("td");u=document.createElement("input");u.type="text";u.id=this.id+"hue2-input";u.value="0";u.style.width="40px";q.appendChild(u);q.appendChild(document.createTextNode(" \xB0"));q.style.whiteSpace="nowrap";j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");u=document.createElement("input");u.type="radio";u.id=this.id+"saturation2-radio";u.value="s";q.appendChild(u);j.appendChild(q);q=document.createElement("td");r=document.createElement("label");r.htmlFor=this.id+"saturation2-radio";r.innerText="S:";q.appendChild(r);j.appendChild(q);q=document.createElement("td");u=document.createElement("input");u.type="text";u.id=this.id+"saturation2-input";u.value="100";u.style.width="40px";q.appendChild(u);q.appendChild(document.createTextNode(" %"));q.style.whiteSpace="nowrap";j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");u=document.createElement("input");u.type="radio";u.id=this.id+"lightness-radio";u.value="l";q.appendChild(u);j.appendChild(q);q=document.createElement("td");r=document.createElement("label");r.htmlFor=this.id+"lightness-radio";r.innerText="L:";q.appendChild(r);j.appendChild(q);q=document.createElement("td");u=document.createElement("input");u.type="text";u.id=this.id+"lightness-input";u.value="100";u.style.width="40px";q.appendChild(u);q.appendChild(document.createTextNode(" %"));q.style.whiteSpace="nowrap";j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");q.innerHTML="Hex:";j.appendChild(q);q=document.createElement("td");q.colSpan="2";u=document.createElement("input");u.type="text";u.id=this.id+"hex-input";u.value="";u.style.width="65px";q.appendChild(u);j.appendChild(q);z.appendChild(j);j=document.createElement("tr");q=document.createElement("td");r=document.createElement("label");r.innerText="Name:";r.id=this+"name-label";r.style.marginLeft="-12px";q.appendChild(r);j.appendChild(q);q=document.createElement("td");q.colSpan="2";u=document.createElement("input");u.type="text";u.id=this.id+"color-name";u.value="";u.title="Enter the name of a color (e.g. blue)";u.style.width="65px";q.appendChild(u);j.appendChild(q);z.appendChild(j);n.appendChild(B);n.appendChild(z);var m=document.createElement("div");m.className="ms-cp-right-outer";n.appendChild(m);var k=document.createElement("div");k.style.height="110px";m.appendChild(k);var g=document.createElement("div");g.innerHTML="Ok";g.className="ms-gradient-button ms-cp-button";g.style.display="block";g.style.width="115px";g.addEventListener("click",function(i){this.save()}.bind(this));k.appendChild(g);var g=document.createElement("div");g.innerHTML="Cancel";g.className="ms-gradient-button ms-cp-button";g.style.display="block";g.style.width="115px";g.addEventListener("click",function(i){this.cancel()}.bind(this));k.appendChild(g);if(this.settings.allowGradient&&!this.settings.gradient){var g=document.createElement("div");g.type="button";g.id=this.id+"add-gradient";g.innerHTML="Add Gradient";g.className="ms-gradient-button ms-cp-button";g.title="Click to create a gradient";g.style.display="block";g.style.width="115px";g.addEventListener("click",function(){this.openGradient(undefined,true)}.bind(this));k.appendChild(g)}m.appendChild(this.cpLibrary.createForm());var v=document.createElement("div");v.style.display="none";v.id=this.id+"cpimages";var H=document.createElement("img");H.src=this.settings.imgPath+"rangearrows.gif";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"mappoint.gif";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-saturation.png";H=document.createElement("img");H.src=this.settings.imgPath+"bar-brightness.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-blue-tl.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-blue-tr.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-blue-bl.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-blue-br.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-red-tl.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-red-tr.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-red-bl.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-red-br.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-green-tl.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-green-tr.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-green-bl.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"bar-green-br.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"map-red-max.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"map-red-min.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"map-green-max.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"map-green-min.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"map-blue-max.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"map-blue-min.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"map-saturation.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"map-saturation-overlay.png";v.appendChild(H);H=document.createElement("img");H.src=this.settings.imgPath+"map-brightness.png";v.appendChild(H);if(!$ms.$("cp-map-hue-png")){H=document.createElement("img");H.src=this.settings.imgPath+"map-hue.png";H.id="cp-map-hue-png";v.appendChild(H);n.appendChild(v)}H=document.createElement("img");H.src=this.settings.imgPath+"map-hsl-hue.png";v.appendChild(H);n.appendChild(v);this.settings.container.appendChild(n);H=document.createElement("img");H.src=this.settings.imgPath+"map-hsl-saturation.png";v.appendChild(H);n.appendChild(v);this.settings.container.appendChild(n);H=document.createElement("img");H.src=this.settings.imgPath+"map-hsl-saturation-overlay.png";v.appendChild(H);n.appendChild(v);this.settings.container.appendChild(n);H=document.createElement("img");H.src=this.settings.imgPath+"map-hsl-lightness.png";v.appendChild(H);n.appendChild(v);this.settings.container.appendChild(n);n.style.fontSize=$ms.targetFontSize(this.settings.fontSize,n);return n};c.prototype.pin=function(){var g=new $msRoot.LocalData();if(this.isPinned){this.isPinned=false;if(isNaN(parseInt(this.container.style.top))){return}this.container.style.top=(Math.max(0,parseInt(this.container.style.top)-4))+"px";$ms.removeClass($ms.$(this.id+"pin-button"),"ms-pinned-button");$ms.addClass($ms.$(this.id+"pin-button"),"ms-unpinned-button");g.setProperty("colorpicker","pin",false)}else{if(this.settings.gradient){this.isPinned=true;this.pinToGradient();g.setProperty("colorpicker","pin",true)}}};c.prototype.pinToGradient=function(){if(!this.settings.gradient){return}this.isPinned=true;var g=$ms.getOffset(this.settings.gradient.container);var h=$ms.getOffset(this.container);var j=(g.top-h.height)+"px";var i=g.left+"px";if(parseInt(j)<0){this.settings.gradient.container.style.top=g.top+Math.abs(parseFloat(j))+"px";j="0px"}this.container.style.top=j;this.container.style.left=i;$ms.addClass($ms.$(this.id+"pin-button"),"ms-pinned-button");$ms.removeClass($ms.$(this.id+"pin-button"),"ms-unpinned-button")};c.prototype.pinGradient=function(){if(!this.settings.gradient){return}var g=$ms.getOffset(this.container);var i=(g.top+g.height)+"px";var h=g.left+"px";this.settings.gradient.container.style.top=i;this.settings.gradient.container.style.left=h;this.settings.gradient.drop(true)};c.prototype.drop=function(g){if($ms.hasClass(this.container,"display-none")){return}this.map.setPositioningVariables();this.slider.setPositioningVariables();this.opacitySlider.setPositioningVariables();if(typeof g=="boolean"&&g){if(this.isPinned){this.pinToGradient()}}else{if(this.isPinned){this.pinGradient()}}};c.prototype.disableOpacity=function(g){this.opacitySlider.disable();this.opacityInput.disable="disabled";$ms.addClass(this.opacityInput,"ms-disabled")};c.prototype.enableOpacity=function(g){this.opacitySlider.enable();this.opacityInput.removeAttribute("disabled");$ms.removeClass(this.opacityInput,"ms-disabled")};c.prototype.keyup=function(g){if(g.keyCode==27){this.close();g.stopPropagation()}};c.prototype.sliderMouseup=function(g){this.cvp.setColorName()};c.prototype.getCss=function(){if(this.notSetCheck.checked){return"<span style='color:red'>Color is not set.</span>"}else{var i="<span style='margin-right:5px'>"+this.cvp.color.rgbString+"</span>";if(this.opacityInput.value==100||this.opacityInput.value==0){var g="hsl("+this.cvp.color.h2+","+this.cvp.color.s2+","+this.cvp.color.l+")"}else{var g="hsla("+this.cvp.color.h2+","+this.cvp.color.s2+","+this.cvp.color.l+","+$ms.round(this.opacityInput.value/100,2)+")"}g="<span style='margin-right:5px'>"+g+"</span>";var h="<span>hsv("+this.cvp.color.h+","+this.cvp.color.s+","+this.cvp.color.v+")</span>";return i+g+h}};c.prototype.setColor=function(h){var g;if(typeof h=="undefined"){return}else{if(typeof h=="string"){g=$msRoot.colorMethods.colorInfo(h);if(h.length>0&&g.rgbString.length==0){return}}else{g=h;if(typeof g.alpha=="undefined"){g.alpha=1}}}if(this.settings.allowGradient&&typeof g.gradient!=="undefined"){this.openGradient(g.gradient,true);return}this.cvp.hexInput.value=g.hex;this.opacityInput.value=parseInt(g.alpha*100);this.cvp.setValuesFromHex();this.cpLibrary.colorDeselect();this.positionArrows();this.updateVisuals();this.updateGradientFromInput()};c.prototype.openGradient=function(h,g,m){var l="1";var i;if(typeof h=="undefined"){if(this.opacityInput.value.length>0){l=$ms.round(parseFloat(this.opacityInput.value/100),2)}if(this.notSetCheck.checked||this.cvp.hexInput.value==""){h=$msRoot.colorMethods.rgbToRgba([255,255,255],l)}else{h=this.cvp.color.rgbString}}if(!this.settings.gradient){var k=$ms.getOffset(this.container);var j={startColor:this.settings.startColor,imgPath:this.settings.imgPath,target:this.settings.target,cbChange:this.settings.cbChange,cbCreate:this.settings.cbCreate,cbClose:this.settings.cbClose,top:(k.top+window.pageYOffset)+"px",left:k.left+window.pageXOffset+"px",zIndex:this.settings.zIndex,cbUpdateColorPicker:this.cbUpdateColorPicker.bind(this),container:this.container.parentNode,colorPicker:g?undefined:this};this.settings.gradient=new $msRoot.Gradient(j)}this.settings.gradient.showGradient(h);if(g){this.settings.gradient.cbUpdateColorPicker=undefined;this.settings.gradient=undefined;this.close();if(m){this.settings.gradient.close()}}else{this.cbUpdateColorPicker(h);this.hide()}};c.prototype.cbUpdateColorPicker=function(g){if($ms.hasClass(this.container,"display-none")){return}this.setColor(g)};c.prototype.updateGradientFromInput=function(){if(!this.settings.gradient){return}if(!this.settings.cbUpdateGradientFromColor){return}if(isNaN(this.opacityInput.value)){this.opacityInput.value=100}var g=$ms.round(this.opacityInput.value/100,2);this.settings.cbUpdateGradientFromColor(this.cvp.color)};$msRoot.getChildClasses(c,"ColorPicker");return c})();