
$msRoot.createNS("Slider");$msRoot.Slider=(function(l,c){var m=[];var j=0;var n=false;var e;var d=false;var b=false;var a=[];var i=false;var k={xMinValue:0,xMaxValue:100,yMinValue:0,yMaxValue:100,imgPath:"",arrowImage:"slider.gif",container:"",direction:"horizontal",snapY:1,snapX:1,scale:1,bar2:{id:""},cbSliderArrowMousedown:undefined,cbSliderBarMousedown:undefined,cbSliderMouseup:undefined,cbSliderArrowDblclick:undefined,ignoreBarMousedown:false,target:undefined,sliderInput:false,parentNode:undefined,hideCursor:false,throttle:0};f.getInstance=function(q,o){for(var p=0;p<m.length;p++){if(typeof q!=="undefined"){if(m[p].id==q){return m[p]}}else{if(typeof o!=="undefined"){if(typeof o=="object"&&o!==null){o=o.id}if(m[p]._bar.id&&m[p]._bar.id==o){return m[p]}}else{return m}}}};f.addScrollListener=function(r,o){for(var q=0;q<a;q++){if(a[q].element.id==r.id){for(var p=q;p<a[q].instances.length;p++){if(a[q].instances[p].id==o.id){return}}a[q].instances.push(this);return}}r.addEventListener("scroll",f.drop);a.push({element:r,instances:new Array(o)})};f.removeScrollListeners=function(o){for(var q=0;q<a;q++){for(var p=q;p<a[q].instances.length;p++){if(a[q].instances[p].id==o.id){if(a[q].instances.length==1){a[q].instances[p].element.removeEventListener("scroll",f.drop);a.splice(q,1)}else{a[q].instances.splice(p,1)}}}}};f.drop=function(){if(i){return}i=true;for(var o=0;o<m.length;o++){m[o].setPositioningVariables()}i=false};if(!b){b=true;window.addEventListener("scroll",f.drop)}function h(o){if(this.disabled){return}if(!n){return}var p=f.getInstance(e);if(!p){e=undefined;n=false;console.log("Can't find slider instance for slider mousemove");return}p.mouseMove.call(p,o)}function g(o){if(this.disabled){return}if(!n){return}var p=f.getInstance(e);if(!p){console.log("Can't find slider instance for slider mouseup");return}p.mouseup.call(p,o)}function f(t,s){this.xValue=0;this.yValue=0;m.push(this);this.id="ms-slider-"+j++;this.settings=$ms.cloneSettings(k,s);if(this.settings.imgPath.length>0&&this.settings.imgPath.substr(-1)!=="/"){this.settings.imgPath+="/"}if(this.settings.sliderInput){this.createSliderInput()}else{this.bar=t;this.container=s.container}if(typeof this.settings.arrowImage!=="undefined"){this.arrow=document.createElement("img")}else{this.arrow=document.createElement("div")}var r=this.settings.sliderArrowClass?this.settings.sliderArrowClass:"ms-slider-arrow";if(r.length>0){$ms.addClass(this.arrow,r)}this.arrow.id=this.id+"-slider-arrow";this.arrow.border=0;this.arrow.src=this.settings.imgPath+this.settings.arrowImage;this.arrow.addEventListener("load",function u(){this.setArrowPositionFromValues()}.bind(this),false);this.arrow.margin=0;this.arrow.padding=0;this.arrow.style.position="absolute";this.arrow.style.top="0px";this.arrow.style.left="0px";if(this.container.style.position!=="relative"&&this.container.style.position!=="absolute"){this.container.style.position="relative"}this.container.appendChild(this.arrow);this.setPositioningVariables();if(!this.settings.ignoreBarMousedown){this.bar.addEventListener("mousedown",function(v){this.barMousedown(v)}.bind(this))}this.bar.addEventListener("mouseup",function(v){this.mouseup(v)}.bind(this));this.bar.addEventListener("mousemove",function(v){h(v)});this.arrow.addEventListener("mousedown",function(v){this.arrowMousedown(v)}.bind(this));this.arrow.addEventListener("mouseup",function(v){this.mouseup(v)}.bind(this));this.arrow.addEventListener("mousemove",function(v){h(v)});if(this.settings.cbSliderArrowDblclick){this.arrow.addEventListener("dblclick",function(v){this.settings.cbSliderArrowDblclick(v,this)}.bind(this))}if(!d){d=true;document.body.addEventListener("mousemove",function(v){h(v)});document.body.addEventListener("mouseup",function(v){g(v)})}if(this.settings.bar2.id){this.settings.bar2.addEventListener("mousemove",function(v){h(v)}.bind(this))}if(this.settings.parentNode){var q=this.settings.parentNode;while(q){var o=getComputedStyle(q).getPropertyValue("overflow-y");var p=getComputedStyle(q).getPropertyValue("overflow-y");if(o=="auto"||o=="scroll"||p=="auto"||p=="scroll"||p=="visible"){f.addScrollListener(q,this)}if(q.nodeName.toLowerCase()=="body"){break}q=q.parentNode}}this.setArrowPositionFromValues();if(this.onValuesChanged){this.onValuesChanged(this)}}f.prototype.close=function(){f.removeScrollListeners(this);if(this.arrow.parentNode){this.arrow.parentNode.removeChild(this.arrow)}for(var o=0;o<m.length;o++){if(m[o].id==this.id){m.splice(o,1);break}}if(this.cbClose){this.cbClose()}};f.prototype.setPositioningVariables=function(){var o=getComputedStyle(this.bar);this.barBorderWidth=parseFloat(o.getPropertyValue("border-left-width"))+parseFloat(o.getPropertyValue("border-right-width"));this.barBorderHeight=parseFloat(o.getPropertyValue("border-top-width"))+parseFloat(o.getPropertyValue("border-bottom-width"));this.barWidth=parseFloat(o.getPropertyValue("width"));this.barHeight=parseFloat(o.getPropertyValue("height"));var q=$ms.getOffset(this.bar);this.barTop=q.y;this.barLeft=q.x;this.barBottom=this.barTop+this.barHeight;this.barRight=this.barLeft+this.barWidth;var p=$ms.getOffset(this.arrow);this.arrowWidth=parseFloat(getComputedStyle(this.arrow).getPropertyValue("width"))||0;this.arrowHeight=parseFloat(getComputedStyle(this.arrow).getPropertyValue("height"))||0};f.prototype.setArrowPositionFromValues=function(){var u=this;this.setPositioningVariables();var p=0;var o=0;if(this.settings.direction!=="horizontal"&&this.settings.direction!=="both"){}else{if(this.settings.xMinValue!=this.settings.xMaxValue){if(this.xValue==this.settings.xMinValue){p=0}else{if(this.xValue==this.settings.xMaxValue){p=this.barWidth-1}else{var t=this.settings.xMaxValue;if(this.settings.xMinValue<1){t=t+Math.abs(this.settings.xMinValue)+1}var r=this.xValue;if(this.xValue<1){r=r+1}p=r/t*this.barWidth;if(parseFloat(p)==(t-1)){p=t}else{p=parseFloat(p)}if(this.settings.xMinValue<1){p=p-Math.abs(this.settings.xMinValue)-1}}}}}if(this.settings.direction!=="vertical"&&this.settings.direction!=="both"){}else{if(this.settings.yMinValue!=this.settings.yMaxValue){if(this.yValue==this.settings.yMinValue){o=0}else{if(this.yValue==this.settings.yMaxValue){o=this.barHeight-1}else{var s=this.settings.yMaxValue;if(this.settings.yMinValue<1){s=s+Math.abs(this.settings.yMinValue)+1}var q=this.yValue;if(this.yValue<1){q=q+1}var o=q/s*this.barHeight;if(parseFloat(o)==(s-1)){o=s}else{o=parseFloat(o)}if(this.settings.yMinValue<1){o=o-Math.abs(this.settings.yMinValue)-1}}}}}this.setArrowPosition(p,o)};f.prototype.setArrowPosition=function(o,r){if(o<0){o=0}if(o>this.barWidth){o=this.barWidth}if(r<0){r=0}if(r>this.barHeight){r=this.barHeight}if(this.settings.direction!=="horizontal"&&this.settings.direction!=="both"){o=0}if(this.settings.direction!=="vertical"&&this.settings.direction!=="both"){r=0}var q=o;var p=r;if(this.settings.direction=="horizontal"||this.settings.direction=="both"){q-=parseFloat(this.arrowWidth/2);q=Math.round(q/this.settings.snapX)*this.settings.snapX}else{q+=((this.barWidth+this.barBorderWidth)-this.arrowWidth)/2}if(this.settings.direction=="vertical"||this.settings.direction=="both"){p-=parseFloat(this.arrowHeight/2);p=Math.round(p/this.settings.snapY)*this.settings.snapY}else{p+=((this.barHeight+this.barBorderHeight)-this.arrowHeight)/2}this.arrow.style.left=q+"px";this.arrow.style.top=p+"px"};f.prototype.barMousedown=function(o){if(this.disabled){o.preventDefault();return}this.setPositioningVariables();if(this.settings.cbSliderBarMousedown){if(!this.settings.cbSliderBarMousedown(o,this)){return}}this.mousedown(o);this.deltaT=this.settings.throttle+1;this.setValuesFromMousePosition(o);this.update()};f.prototype.arrowMousedown=function(o){if(this.disabled){o.preventDefault();return}this.setPositioningVariables();if(this.settings.cbSliderArrowMousedown){if(!this.settings.cbSliderArrowMousedown(o,this)){return}}this.mousedown(o);this.update()};f.prototype.mousedown=function(o){o.preventDefault();n=true;e=this.id;if(this.settings.hideCursor){$ms.addClass(this.arrow,"ms-nocursor");$ms.addClass(this.bar,"ms-nocursor")}};f.prototype.mouseMove=function(o){this.mouseMoveEvent=o};f.prototype.update=function(){var q=this;var o;(function p(r){if(!o){o=r}q.deltaT=r-o;if(n){requestAnimationFrame(function(){p(Date.now())});if(q.mouseMoveEvent){q.setValuesFromMousePosition(q.mouseMoveEvent)}}if(q.deltaT>q.settings.throttle){o=r}})(Date.now())};f.prototype.mouseup=function(o){if(this.disabled){o.preventDefault();return}n=false;this.mouseMoveEvent=null;if(this.settings.cbSliderMouseup){this.settings.cbSliderMouseup(o,this)}if(this.settings.hideCursor){$ms.removeClass(this.arrow,"ms-nocursor");$ms.removeClass(this.bar,"ms-nocursor")}};f.prototype.getValuesFromMousePosition=function(o){return this.setValuesFromMousePosition(o,true)};f.prototype.setValuesFromMousePosition=function(t,p){var v={x:t.pageX,y:t.pageY};var u=0;var s=0;if(v.x<this.barLeft){u=0}else{if(v.x>this.barRight){u=this.barWidth}else{u=v.x-this.barLeft+1}}if(v.y<this.barTop){s=0}else{if(v.y>this.barBottom){s=this.barHeight}else{s=v.y-this.barTop+1}}var q=this.settings.xMaxValue;if(this.settings.xMinValue<1){q=q+Math.abs(this.settings.xMinValue)+1}var o=this.settings.yMaxValue;if(this.settings.yMinValue<1){o=o+Math.abs(this.settings.yMinValue)+1}var r=parseFloat(u/this.barWidth*q);r=Math.min(r,this.settings.xMaxValue);r=Math.max(r,this.settings.xMinValue);var w=parseFloat(s/this.barHeight*o);w=Math.min(w,this.settings.yMaxValue);w=Math.max(w,this.settings.yMinValue);if(p){return{x:r,y:w}}this.xValue=r;this.yValue=w;if(this.settings.xMaxValue==this.settings.xMinValue){u=0}if(this.settings.yMaxValue==this.settings.yMinValue){s=0}this.setArrowPosition(u,s);if(this.onValuesChanged&&this.deltaT>this.settings.throttle){this.onValuesChanged(this)}};f.prototype.disable=function(){var p=this.settings.target;this.disabled=true;$ms.addClass(this.bar,"ms-disabled");if(p){if(!Array.isArray(p)){p=[];p.push(this.settings.target)}for(var o=0;o<p.length;o++){$ms.addClass(p[o],"ms-disabled");p[o].disabled="disabled"}}};f.prototype.enable=function(){var p=this.settings.target;this.disabled=false;$ms.removeClass(this.bar,"ms-disabled");if(p){if(!Array.isArray(p)){p=[];p.push(this.settings.target)}for(var o=0;o<p.length;o++){$ms.removeClass(p[o],"ms-disabled");p[o].removeAttribute("disabled")}}};f.prototype.createSliderInput=function(){var o=1,u=100;var q=4;var s="px";var r;var x=this.id+"slider-input";if(typeof this.settings.min!=="undefined"&&typeof this.settings.max!=="undefined"){if(this.settings.direction=="horizontal"){this.settings.xMinValue=this.settings.min;this.settings.xMaxValue=this.settings.max;this.settings.yMinValue=1;this.settings.yMaxValue=1}else{this.settings.yMinValue=this.settings.min;this.settings.yMaxValue=this.settings.max;this.settings.xMinValue=1;this.settings.xMaxValue=1}}if(typeof this.settings.inputId!=="undefined"){x=this.settings.inputId}u=u*q;o=o*q;this.input=document.createElement("input");this.input.id=x;this.input.className="ms-slider-input";if(this.settings.inputWidth){this.input.style.width=this.settings.inputWidth+"px"}if(this.settings.unitOptions){this.scale=1;if(!this.settings.element||!this.settings.propName||typeof this.settings.units=="undefined"){r="px"}else{r=$ms.splitUnit(this.settings.element.style[this.settings.propName]).unit||s}this.scale=$ms.propUnitsScale(r);this.unitCombo=$ms.createCombo(this.settings.unitOptions);this.unitCombo.id=x+"-units";this.unitCombo.className="ms-slider-units";this.unitCombo.onchange=new function(){var y;return function(){if(typeof y=="undefined"){y=r}var z=$ms.convertUnits(this.input.value+y,this.unitCombo.value);this.input.value=z.numeric;this.scale=$ms.propUnitsScale(this.unitCombo.value);y=this.unitCombo.value;this.input.onchange();this.onValuesChanged()}.bind(this)}.bind(this)}this.container=document.createElement("div");this.container.className="ms-slider-bar-container";this.bar=document.createElement("div");this.bar.className="ms-slider-bar";this.bar.style.width=(this.settings.sliderWidth||100)+"px";this.container.appendChild(this.bar);if(this.settings.parentNode){this.settings.parentNode.appendChild(this.input);if(this.settings.units){this.settings.parentNode.appendChild(this.unitCombo)}if(this.settings.button){this.settings.buttonHeight=this.settings.buttonHeight?this.settings.buttonHeight:"12px";var t=document.createElement("div");var w=$ms.elementSize(this.input).height;var p=document.createElement("div");p.className="ms-gradient-button ms-button-tool";p.style.height=w+"px";p.style.lineHeight=w+"px";p.innerHTML="►";var v=this.settings.parentNode;while(v&&v.style){if(v.style.position=="relative"||v.style.position=="absolute"){t.style.position="absolute";break}v=v.parentNode}if(t.style.position!=="absolute"){t=sliderContainer}else{t.appendChild(sliderContainer)}t.className="display-none";this.sliderButtonClick=function(){if(this.disabled){return}if(!$ms.hasClass(t,"display-none")){$ms.addClass(t,"display-none");return}if(t.style.position=="absolute"){t.style.padding="3px 10px";t.style.border="2px solid rgb(155,155,155)";t.style.borderRadius="5px";t.style.visibility="hidden";$ms.removeClass(t,"display-none");var z=(parseInt(p.style.height)-parseInt(t.offsetHeight))/2;var A=$ms.getOffset(p);var y=$ms.getOffset(v);t.style.top=(A.top-y.top+z)+"px";t.style.left=(A.left-y.left+A.width+2)+"px";t.style.backgroundColor="rgb(218,218,218)"}this.setPositioningVariables();this.setArrowPositionFromValues();t.style.visibility="visible";$ms.removeClass(t,"display-none")};p.onclick=this.sliderButtonClick;this.settings.parentNode.appendChild(p)}if(this.settings.textAfterInput){this.settings.parentNode.appendChild(document.createTextNode(this.settings.textAfterInput))}if(this.settings.button){this.settings.parentNode.appendChild(t)}else{this.settings.parentNode.appendChild(this.container)}}this.onValuesChanged=function(){this.input.value=Math.round((Math.round(this.xValue/this.settings.snapX)*this.settings.snapX)/this.settings.snapX);this.input.value=this.input.value/this.scale;if(typeof this.settings.unitOptions=="undefined"&&typeof this.settings.units!=="undefined"){this.input.value+=this.settings.units}if(this.settings.cbUpdateSource){this.settings.cbUpdateSource()}}.bind(this);this.input.onchange=function(){if(this.input.value==""){this.xValue=0;this.setArrowPositionFromValues()}else{var y=(this.input.value*1)||0;y=y*this.scale;this.xValue=Math.round((y*q)/q)*q;this.setArrowPositionFromValues()}}.bind(this)};return f})();