
$msRoot.createNS("CustomDialog");$msRoot.CustomDialog=(function(f){var a=[];var e=0;var d={fontSize:80,dialogTitle:"",text:"Confirm?",buttons:[{label:"Ok",title:"Okays the request",cb:undefined},{label:"Cancel",title:"Cancels the request",cb:undefined}],buttonClass:"ms-gradient-button",position:"absolute",zIndex:2000,backgroundColor:"rgb(230,230,230)",borderColor:"4px ridge rgb(200,200,200)",top:undefined,left:undefined,width:undefined,height:undefined,minWidth:100,minHeight:100,maxWidth:500,maxHeight:500,textAlign:"left",cbClose:undefined,buttonsOnTop:false,input:undefined,id:""};var b=[];c.getInstance=function(h){if(typeof h!=="undefined"){for(var g=0;g<a.length;g++){if(a[g].id==h){return a[g]}}}else{return a}};c.closeDialogs=function(h){for(var g=0;g<a.length;g++){if(a[g].settings.id==h){a[g].close()}}};function c(x){a.push(this);this.id="ms-dialog-"+e+++"-";this.settings=$ms.cloneSettings(d,x);this.container=document.createElement("div");$ms.addClass(this.container,"visibility-hidden");document.body.appendChild(this.container);this.container.style.position=this.settings.position;this.container.id=this.id+"dialog-"+a.length;this.container.style.zIndex=this.settings.zIndex;this.container.style.backgroundColor=this.settings.backgroundColor;this.container.style.textAlign="center";this.container.style.border=this.settings.borderColor;this.container.style.fontSize=$ms.targetFontSize(this.settings.fontSize);var o=document.createElement("div");o.id=this.id+"title-bar";o.style.minHeight="20px";o.className="ms-title-bar";o.innerHTML=this.settings.dialogTitle;var h=$ms.createCloseButton(this.id,function(){this.close();if(this.settings.cbClose){this.settings.cbClose()}}.bind(this));o.appendChild(h);this.container.appendChild(o);$ms.draggable(this.container,{scope:"default",handle:this.id+"title-bar",});var n=document.createElement("div");n.style.width="100%";n.style.height="calc(100% - 20px)";n.style.position="relative";this.container.appendChild(n);var j=document.createElement("div");j.style.overflow="auto";j.style.textAlign=this.settings.textAlign;j.style.height="100%";j.style.margin="0 10px";n.appendChild(j);if(!Array.isArray(this.settings.text)){this.settings.text=[this.settings.text]}for(var v=0;v<this.settings.text.length;v++){var q=document.createElement("div");q.innerHTML=this.settings.text[v];j.appendChild(q)}if(this.settings.input){var y=document.createElement("div");y.style.margin="5px 0";var m=document.createElement("label");m.innerText=this.settings.input.label;m.style.display="inline-block";y.appendChild(m);var p=document.createElement("input");if(typeof this.settings.input.value!=="undefined"){p.value=this.settings.input.value}if(typeof this.settings.input.width!=="undefined"){p.style.width=parseInt(""+this.settings.input.width)+"px"}p.style.display="inline-block";if(this.settings.input.onchange){p.onchange=this.settings.input.onchange}if(this.settings.input.onkeydown){p.onkeydown=this.settings.input.onkeydown}if(this.settings.input.onkeyup){p.onkeyup=this.settings.input.onkeyup}y.appendChild(p);j.appendChild(y);this.settings.input.element=p}var k=document.createElement("div");k.style.margin="10px 0";for(var v=0;v<this.settings.buttons.length;v++){var g=document.createElement("div");g.innerHTML=this.settings.buttons[v].label;g.className=this.settings.buttonClass;g.style.display="inline-block";var u=v==0?"0":"5px";g.style.margin="5px 0 0 "+u;g.title=this.settings.buttons[v].title;var r=this.close.bind(this);var t=this.settings.buttons[v].cb;var w=this;g.addEventListener("click",function(i){return function(){r();if(i){i(w)}}}(t));k.appendChild(g)}this.keypressListenerFn=this.keypressListener.bind(this);document.body.addEventListener("keypress",this.keypressListenerFn,false);if(this.settings.buttonsOnTop){n.insertBefore(k,j)}else{n.appendChild(k)}var s=$ms.elementSize(this.container);if(!this.settings.width){this.settings.width=Math.min(this.settings.maxWidth,Math.max(this.settings.minWidth,s.width+8))}this.container.style.width=parseInt(""+this.settings.width)+"px";var s=$ms.elementSize(this.container);if(!this.settings.height){this.settings.height=Math.min(this.settings.maxHeight,Math.max(this.settings.minHeight,s.height+8))}this.container.style.height=parseInt(""+this.settings.height)+"px";if(typeof this.settings.top=="undefined"){this.settings.top=Math.max(0,(window.innerHeight-this.settings.height))/2+"px"}if(typeof this.settings.left=="undefined"){this.settings.left=Math.max(0,(window.innerWidth-this.settings.width))/2+"px"}this.container.style.top=parseInt(""+this.settings.top)+"px";this.container.style.left=parseInt(""+this.settings.left)+"px";var l=$ms.elementSize(k).height+20-1;j.style.height="calc(100% - "+l+"px)";$ms.removeClass(this.container,"visibility-hidden");if(this.settings.input&&p){p.focus()}}c.prototype.keypressListener=function(h){if(h.stopPropagation){h.stopPropagation()}switch(h.keyCode){case 13:for(var g=0;g<this.settings.buttons.length;g++){if(this.settings.buttons[g].enterKey){this.close().bind(this);if(this.settings.buttons[g].cb){this.settings.buttons[g].cb(dialog)}break}}break;case 27:for(var g=0;g<this.settings.buttons.length;g++){if(this.settings.buttons[g].cancelKey||this.settings.buttons[g].escapeKey){this.close().bind(this);if(this.settings.buttons[g].cb){this.settings.buttons[g].cb(dialog)}break}}break}};c.prototype.close=function(){if(this.container.parentNode){this.container.parentNode.removeChild(this.container)}for(var g=0;g<a.length;g++){if(a[g].id==this.id){a.splice(g,1);break}}document.removeEventListener("keypress",this.keypressListenerFn)};return c})();