
$ms.resizable=function(a,b){return function(c,d){return new $msRoot.Resize(c,d)}(a,b)};$msRoot.Resize=(function(c,f){var a=[];var e=0;var d={handles:["se"],hovers:[],cbResize:undefined,cbStart:undefined,cbStop:undefined,boundingBoxContainer:undefined,alsoResize:undefined,cornerHandles:"triangle",handleColor:"",negativeSizeAllowed:false,minWidth:undefined,minHeight:undefined,minTop:0,minLeft:0,disabled:false,altMirrors:true};b.getInstance=function(j,g){for(var h=0;h<a.length;h++){if(typeof j!=="undefined"){if(a[h].id==j){return a[h]}}else{if(typeof g!=="undefined"){if(typeof g=="object"&&g!==null){g=g.id}if(a[h].element&&a[h].element.id==g){return a[h]}}else{return a}}}};function b(h,j){this.element;this.allow={top:false,left:false,bottom:false,right:false,width:false,height:false};this.settings=d;this.resizeMousemoveListener;this.resizeMouseupListener;this.hoverMousemoveListener;this.hoverMousedownListener;this.handleMousedownListener;this.boundingBoxMousedownListener;this.resizing=false;this.handleElements=[];this.mousedownTarget;this.reset();this.id="_resize"+e+++"-";if(a.length>0){for(var g=0;g<a.length;g++){if(a[g].id==this.id){return a[g]}}}a.push(this);if(typeof j!=="undefined"){this.register(h,j)}}b.prototype.reset=function(){this.resizing=false;this.lock="";this.overBorder="";this.startWidth=0;this.startHeight=0;this.startMouseX=0;this.startMouseY=0;this.diffX=0;this.diffY=0;this.startTop=0;this.startLeft=0;this.startElementTop;this.startElementLeft;this.startElementWidth;this.startElementHeight;this.mirror=false;this.rightIsZero=false;if(this.element){$ms.removeClass(this.element,"ms-cursor-resize-ew");$ms.removeClass(this.element,"ms-cursor-resize-ns");$ms.removeClass(this.element,"ms-cursor-resize-se");$ms.removeClass(this.element,"ms-cursor-resize-sw")}};b.prototype.init=function(j){var n;var i=0,m=0;var l=0,h=0;if(this.overBorder=="e"||this.overBorder=="w"){this.lock="x"}else{if(this.overBorder=="n"||this.overBorder=="s"){this.lock="y"}}if(typeof this.element!=="undefined"&&typeof this.settings.boundingBoxContainer=="undefined"){n=$ms.getOffset(this.element.parentNode);i=parseFloat(getComputedStyle(this.element.parentNode).getPropertyValue("border-left-width"));m=parseFloat(getComputedStyle(this.element.parentNode).getPropertyValue("border-top-width"));h=parseFloat(getComputedStyle(this.element).getPropertyValue("padding-bottom"));l=parseFloat(getComputedStyle(this.element).getPropertyValue("padding-right"))}else{if($ms.$(this.id+"bounding-box")){this.element.parentNode.removeChild(this.element)}this.element=document.createElement("div");this.element.id=this.id+"bounding-box";this.element.style.border="1px solid black";this.element.style.position="absolute";if(typeof this.settings.boundingBoxContainer=="undefined"){this.settings.boundingBoxContainer=document.body}this.settings.boundingBoxContainer.appendChild(this.element);n=$ms.getOffset(this.element.parentNode);this.element.style.left=(j.pageX-n.x)+"px";this.element.style.top=(j.pageY-n.y)+"px"}var k=getComputedStyle(this.element).getPropertyValue("box-sizing");if(k=="border-box"){this.startWidth=this.element.offsetWidth;this.startHeight=this.element.offsetHeight}else{this.startWidth=parseInt(this.element.clientWidth-l);this.startHeight=parseInt(this.element.clientHeight-h)}this.startMouseX=j.pageX;this.startMouseY=j.pageY;var g=this.element.getBoundingClientRect();this.startTop=parseInt(g.top-n.y-m+window.pageYOffset);this.startLeft=parseInt(g.left-n.x-i+window.pageXOffset);if(this.overBorder=="w"||this.overBorder=="nw"||this.overBorder=="sw"){this.rightIsZero=$ms.getPropertyValue(this.element,"right")=="0px"}this.startElementTop=$ms.getPropertyValue(this.element,"top");this.startElementLeft=$ms.getPropertyValue(this.element,"left");this.startElementWidth=$ms.getPropertyValue(this.element,"width");this.startElementHeight=$ms.getPropertyValue(this.element,"height");if(!this.settings.negativeSizeAllowed){if(typeof this.settings.minHeight=="undefined"){this.settings.minHeight=0}if(typeof this.settings.minWidth=="undefined"){this.settings.minWidth=0}}if(this.lock=="x"){$ms.addClass(this.element,"ms-cursor-resize-ew")}else{if(this.lock=="y"){$ms.addClass(this.element,"ms-cursor-resize-ns")}else{if(this.overBorder=="nw"||this.overBorder=="se"){$ms.addClass(this.element,"ms-cursor-resize-se")}else{if(this.overBorder=="ne"||this.overBorder=="sw"){$ms.addClass(this.element,"ms-cursor-resize-sw")}}}}};b.prototype.resizeElement=function(l){if(!this.element){return}if(this.settings.disabled){return}if(!this.resizing){return}this.diffX=parseInt(l.pageX-this.startMouseX);this.diffY=parseInt(l.pageY-this.startMouseY);if(l.altKey){if(this.settings.altMirrors&&!this.settings.negativeSizeAllowed){this.mirror=true;this.allow.top=true;this.allow.left=true}}if(l.shiftKey){var g;if(Math.abs(this.diffX)>Math.abs(this.diffY)){g=this.diffX}else{g=this.diffY}this.diffX=g;this.diffY=g}else{if(l.ctrlKey){if(this.lock.length==0){if(Math.abs(this.diffX)>Math.abs(this.diffY)){this.lock="x"}else{this.lock="y"}}}}if(this.lock=="x"){this.diffY=0}else{if(this.lock=="y"){this.diffX=0}}if(this.overBorder=="n"||this.overBorder=="nw"||this.overBorder=="ne"){var h=this.startHeight-this.diffY*(this.mirror?2:1)}else{var h=this.startHeight+this.diffY*(this.mirror?2:1)}if(this.overBorder=="w"||this.overBorder=="nw"||this.overBorder=="sw"){var k=this.startWidth-this.diffX*(this.mirror?2:1)}else{var k=this.startWidth+this.diffX*(this.mirror?2:1)}var i=this.startTop;var j=this.startLeft;if(this.overBorder=="w"||this.overBorder=="nw"||this.overBorder=="sw"){j=(this.startLeft+this.diffX)}else{if(this.mirror){j=this.startLeft-this.diffX}}if(this.overBorder=="n"||this.overBorder=="nw"||this.overBorder=="ne"){i=(this.startTop+this.diffY)}else{if(this.mirror){i=this.startTop-this.diffY}}if(this.settings.negativeSizeAllowed){if(k<=0){j=(this.startLeft+this.diffX)}if(h<=0){i=(this.startTop+this.diffY)}}else{if(h<=0){h=0}if(h<=this.settings.minHeight){h=this.settings.minHeight;if(this.overBorder=="n"||this.overBorder=="nw"||this.overBorder=="ne"){i=this.startHeight-this.settings.minHeight+this.startTop}}if(k<=0){k=0}if(k<=this.settings.minWidth){k=this.settings.minWidth;if(this.overBorder=="w"||this.overBorder=="nw"||this.overBorder=="sw"){j=this.startWidth-this.settings.minWidth+this.startLeft}}}if((this.allow.top&&i<this.settings.minTop)||(this.allow.left&&j<this.settings.minLeft)){return}if(this.allow.left&&!this.rightIsZero){this.element.style.left=j+"px"}if(this.allow.top&&(this.mirror||this.overBorder=="n"||this.overBorder=="nw"||this.overBorder=="ne"||this.element.id=="bounding-box")){this.element.style.top=i+"px"}if(this.lock!=="y"&&this.allow.width){this.element.style.width=Math.abs(k)+"px"}if(this.lock!=="x"&&this.allow.height){this.element.style.height=Math.abs(h)+"px"}if(this.settings.alsoResize){this.alsoResizeLinked()}if(this.settings.cbResize){if(this.settings.cbClass){this.settings.cbResize.call(this.settings.cbClass,this.element,this)}else{this.settings.cbResize(this.element,this)}}};b.prototype.alsoResizeLinked=function(){if(!this.settings.alsoResize){return}var h=getComputedStyle(this.element).getPropertyValue("width");var o=getComputedStyle(this.element).getPropertyValue("height");if(!Array.isArray(this.settings.alsoResize)){this.settings.alsoResize=new Array(this.settings.alsoResize)}if(Array.isArray(this.settings.alsoResize)){for(var k=0;k<this.settings.alsoResize.length;k++){var l=this.allow.width&&this.lock!=="y";var j=this.allow.height&&this.lock!=="x";var p=false;if($ms.hasClass(this.settings.alsoResize[k],"width100")||this.settings.alsoResize[k].style.width=="100%"||$ms.hasClass(this.settings.alsoResize[k],"width-auto")||this.settings.alsoResize[k].style.width=="auto"){p=true}var g=false;if($ms.hasClass(this.settings.alsoResize[k],"height100")||this.settings.alsoResize[k].style.height=="100%"||$ms.hasClass(this.settings.alsoResize[k],"height-auto")||this.settings.alsoResize[k].style.height=="auto"){g=true}if(this.settings.alsoResize[k].nodeName=="IMG"){this.settings.alsoResize[k].width=parseFloat(h);this.settings.alsoResize[k].height=parseFloat(o)}else{if(l&&!p){this.settings.alsoResize[k].style.width=h}if(j&&!g){this.settings.alsoResize[k].style.height=o}var m=parseInt(getComputedStyle(this.settings.alsoResize[k]).getPropertyValue("width"));var n=parseInt(getComputedStyle(this.settings.alsoResize[k]).getPropertyValue("height"));if(n>parseInt(o)&&j){this.element.style.height=n+"px";this.settings.alsoResize[k].style.height=n+"px"}if(m>parseInt(h)&&l){this.element.style.width=m+"px";this.settings.alsoResize[k].style.width=m+"px"}}}}};b.prototype.mirrorOff=function(){if(this.mirror){this.diffY=this.startTop-parseInt(this.element.style.top);this.diffX=this.startLeft-parseInt(this.element.style.left);this.element.style.top=this.startTop+"px";this.element.style.left=this.startLeft+"px";this.element.style.width=parseInt(this.element.style.width)-this.diffX+"px";this.element.style.height=parseInt(this.element.style.height)-this.diffY+"px";if(this.settings.alsoResize){this.alsoResizeLinked()}}};b.prototype.deleteElement=function(){if(typeof this.element!=="undefined"&&this.element.id=="bounding-box"){if(typeof this.element.parentNode!=="undefined"){if(this.element.parentNode){this.element.parentNode.removeChild(this.element)}}}};b.prototype.hoverBorder=function(h){if(!this.element){return}var g=$ms.innerSize(this.element);var i="";if(this.allow.right&&parseInt(h.offsetX)>=parseInt(g.x-Math.max(6,g.ieBorder.x))){$ms.addClass(this.element,"ms-cursor-col-resize");$ms.removeClass(this.element,"ms-cursor-row-resize");i="e"}else{if(this.allow.bottom&&parseInt(h.offsetY)>=parseInt(g.y-Math.max(6,g.ieBorder.y))){$ms.addClass(this.element,"ms-cursor-row-resize");$ms.removeClass(this.element,"ms-cursor-col-resize");i="s"}else{if(this.allow.left&&h.offsetX<=6){$ms.addClass(this.element,"ms-cursor-col-resize");$ms.removeClass(this.element,"ms-cursor-row-resize");i="w"}else{if(this.allow.top&&h.offsetY<=6){$ms.addClass(this.element,"ms-cursor-row-resize");$ms.removeClass(this.element,"ms-cursor-col-resize");i="n"}else{$ms.removeClass(this.element,"ms-cursor-row-resize");$ms.removeClass(this.element,"ms-cursor-col-resize")}}}}return i};b.prototype.setSettings=function(h){if(typeof h=="undefined"){return}this.settings=d;if(typeof h!=="undefined"){for(var g in h){if(h.hasOwnProperty(g)){this.settings[g]=h[g]}}}};b.prototype.settings=function(g,h){if(!this.settings.hasOwnProperty(g)){return}if(typeof h!=="undefined"){this.settings[g]=h}return this.settings[g]};b.prototype.resizable=function(g,h){this.register(g,h)};b.prototype.register=function(g,h){this.element=g;this.setSettings(h);this.createHandles();this.createHovers();if(this.settings.boundingBoxContainer){this.createBoundingBox()}};b.prototype.destroy=function(){this.close()};b.prototype.close=function(){for(var g=0;g<this.handleElements.length;g++){this.handleElements[g].removeEventListener("mousedown",this.handleMousedownListener);this.handleElements[g].parentNode.removeChild(this.handleElements[g])}this.handleElements=[];if(this.hoverMousemoveListener){this.element.removeEventListener("mousemove",this.hoverMousemoveListener)}if(this.hoverMousedownListener){this.element.addEventListener("mousedown",this.hoverMousedownListener)}if(this.boundingBoxMousedownListener){this.settings.boundingBoxContainer.removeEventListener("mousedown",this.boundingBoxMousedownListener)}};b.prototype.enable=function(){this.settings.disabled=false;for(var g=0;g<this.handleElements.length;g++){$ms.removeClass(this.handleElements[g],"display-none")}};b.prototype.disable=function(){this.settings.disabled=true;for(var g=0;g<this.handleElements.length;g++){$ms.addClass(this.handleElements[g],"display-none")}};b.prototype.createHandles=function(){if(this.settings.handles===""){return}if(!this.element){return}if(this.element.style.position=="static"){return}if(!Array.isArray(this.settings.handles)){this.settings.handles=this.settings.handles.split(",")}var j=["n","s","e","w","se","sw","ne","nw"];for(var g=0;g<this.settings.handles.length;g++){if(j.indexOf(this.settings.handles[g])!==-1){switch(this.settings.handles[g]){case"n":this.allow.top=true;this.allow.height=true;break;case"s":this.allow.bottom=true;this.allow.height=true;break;case"e":this.allow.right=true;this.allow.width=true;break;case"w":this.allow.left=true;this.allow.width=true;break;case"se":this.allow.bottom=true;this.allow.right=true;this.allow.height=true;this.allow.width=true;break;case"sw":this.allow.bottom=true;this.allow.left=true;this.allow.height=true;this.allow.width=true;break;case"ne":this.allow.top=true;this.allow.right=true;this.allow.height=true;this.allow.width=true;break;case"nw":this.allow.top=true;this.allow.left=true;this.allow.height=true;this.allow.width=true;break}var k=document.createElement("div");var h="ms-handle ms-handle-"+this.settings.handles[g];if(this.settings.handles[g].length==2){h+=(this.settings.cornerHandles=="box"?"":"-triangle")}if(this.settings.handleColor=="green"){h+=" "+h+"-green"}if(this.settings.disabled){h+=" display-none"}k.className=h;k.id=this.id+"handle-"+this.settings.handles[g];k.draggable=false;this.handleMousedownListener=function(i){if($ms.detectButton(i)!=="left"){return}this.mousedownHandle(i)}.bind(this);k.addEventListener("mousedown",this.handleMousedownListener,false);this.element.appendChild(k);this.handleElements.push(k)}}};b.prototype.createHovers=function(){var g=false;if(this.settings.hovers===""){return}if(!this.element){return}if(!Array.isArray(this.settings.hovers)){this.settings.hovers=this.settings.hovers.split(",")}var j=["n","s","e","w"];for(var h=0;h<this.settings.hovers.length;h++){if(j.indexOf(this.settings.hovers[h])!==-1){switch(this.settings.handles[h]){case"n":this.allow.top=true;this.allow.height=true;break;case"s":this.allow.bottom=true;this.allow.height=true;break;case"e":this.allow.right=true;this.allow.width=true;break;case"w":this.allow.left=true;this.allow.width=true;break}if(!g){g=true;this.hoverMousemoveListener=function(i){if(this.resizing){return}if(this.settings.disabled){return}i.stopPropagation();this.hoverBorder(i)}.bind(this);this.element.addEventListener("mousemove",this.hoverMousemoveListener,false);this.hoverMousedownListener=function(i){if(this.resizing){return}if(this.settings.disabled){return}if($ms.detectButton(i)!=="left"){return}this.mousedownHover(i)}.bind(this);this.element.addEventListener("mousedown",this.hoverMousedownListener,false)}}}};b.prototype.mousedownHandle=function(g){if(!g.target.classList.contains("ms-handle")){return}this.mousedownTarget=g.target;switch(g.target.id){case this.id+"handle-e":this.overBorder="e";this.lock="x";break;case this.id+"handle-w":this.overBorder="w";this.lock="x";break;case this.id+"handle-n":this.overBorder="n";this.lock="y";break;case this.id+"handle-s":this.overBorder="s";this.lock="y";break;case this.id+"handle-se":this.overBorder="se";this.lock="";break;case this.id+"handle-ne":this.overBorder="ne";this.lock="";break;case this.id+"handle-nw":this.overBorder="nw";this.lock="";break;case this.id+"handle-sw":this.overBorder="sw";this.lock="";break;default:return}this.mousedown(g)};b.prototype.mousedownHover=function(g){this.overBorder=this.hoverBorder(g);switch(this.overBorder){case"e":case"w":this.lock="x";break;case"n":case"s":this.lock="y";break;default:return}this.mousedown(g)};b.prototype.createBoundingBox=function(){if(!this.settings.boundingBoxContainer){return}this.allow={top:true,left:true,bottom:true,right:true,width:true,height:true};this.boundingBoxMousedownListener=function(g){if($ms.detectButton(g)!=="left"){return}this.mousedown(g)}.bind(this);this.settings.boundingBoxContainer.addEventListener("mousedown",this.boundingBoxMousedownListener,false)};b.prototype.mousedownBoundingBox=function(g){this.mousedown(g)};b.prototype.mousedown=function(g){g.preventDefault();this.resizing=true;if(this.settings.cbStart){if(this.settings.cbClass){this.settings.cbStart.call(this.settings.cbClass,this.element,this)}else{this.settings.cbStart(this.element,this)}}this.resizeMousemoveListener=function(h){this.resizeElement(h)}.bind(this);window.addEventListener("mousemove",this.resizeMousemoveListener);this.resizeMouseupListener=function(h){this.mouseup(h)}.bind(this);window.addEventListener("mouseup",this.resizeMouseupListener);this.init(g)};b.prototype.mouseup=function(g){if(g.stopPropagation){g.stopPropagation()}if(this.settings.cbStop){if(this.settings.cbClass){this.settings.cbStop.call(this.settings.cbClass,this.element,this)}else{this.settings.cbStop(this.element,this)}}this.reset();window.removeEventListener("mousemove",this.resizeMousemoveListener);window.removeEventListener("mouseup",this.resizeMouseupListener)};return b})();