'use strict';$ms.resizable=function(l,m){return new $msRoot.Resize(l,m)};
$msRoot.Resize=function(l,m){function d(a,c){this.element;this.allow={top:!1,left:!1,bottom:!1,right:!1,width:!1,height:!1};this.settings=n;this.resizeMousemoveListener;this.resizeMouseupListener;this.hoverMousemoveListener;this.hoverMousedownListener;this.handleMousedownListener;this.boundingBoxMousedownListener;this.resizing=!1;this.handleElements=[];this.mousedownTarget;this.disabled=!1;this.reset();this.id="_resize"+p++ +"-";if(0<f.length)for(var b=0;b<f.length;b++)if(f[b].id==this.id)return f[b];
f.push(this);"undefined"!==typeof c&&this.register(a,c)}var f=[],p=0,n={handles:["se"],hovers:[],cbResize:void 0,cbStart:void 0,cbStop:void 0,boundingBoxContainer:void 0,alsoResize:void 0,cornerHandles:"triangle",handleColor:"",negativeSizeAllowed:!1,minWidth:void 0,minHeight:void 0,minTop:0,minLeft:0,disabled:!1,altMirrors:!0,keepProportion:!1};d.getInstance=function(a,c){for(var b=0;b<f.length;b++)if("undefined"!==typeof a){if(f[b].id==a)return f[b]}else if("undefined"!==typeof c){if("object"==
typeof c&&null!==c&&(c=c.id),f[b].element&&f[b].element.id==c)return f[b]}else return f};d.prototype.reset=function(){this.resizing=!1;this.overBorder=this.lock="";this.startLeft=this.startTop=this.diffY=this.diffX=this.startMouseY=this.startMouseX=this.startHeight=this.startWidth=0;this.startElementTop;this.startElementLeft;this.startElementWidth;this.startElementHeight;this.rightIsZero=this.mirror=!1;this.element&&($ms.removeClass(this.element,"ms-cursor-resize-ew"),$ms.removeClass(this.element,
"ms-cursor-resize-ns"),$ms.removeClass(this.element,"ms-cursor-resize-se"),$ms.removeClass(this.element,"ms-cursor-resize-sw"))};d.prototype.init=function(a){var c=0,b=0,e=0,h=0;if("e"==this.overBorder||"w"==this.overBorder)this.lock="x";else if("n"==this.overBorder||"s"==this.overBorder)this.lock="y";if("undefined"!==typeof this.element&&"undefined"==typeof this.settings.boundingBoxContainer){var g=$ms.getOffset(this.element.parentNode);c=parseFloat(getComputedStyle(this.element.parentNode).getPropertyValue("border-left-width"));
b=parseFloat(getComputedStyle(this.element.parentNode).getPropertyValue("border-top-width"));h=parseFloat(getComputedStyle(this.element).getPropertyValue("padding-bottom"));e=parseFloat(getComputedStyle(this.element).getPropertyValue("padding-right"))}else $ms.$(this.id+"bounding-box")&&this.element.parentNode.removeChild(this.element),this.element=document.createElement("div"),this.element.id=this.id+"bounding-box",this.element.style.border="1px solid black",this.element.style.position="absolute",
"undefined"==typeof this.settings.boundingBoxContainer&&(this.settings.boundingBoxContainer=document.body),this.settings.boundingBoxContainer.appendChild(this.element),g=$ms.getOffset(this.element.parentNode),this.element.style.left=a.pageX-g.x+"px",this.element.style.top=a.pageY-g.y+"px";"border-box"==getComputedStyle(this.element).getPropertyValue("box-sizing")?(this.startWidth=this.element.offsetWidth,this.startHeight=this.element.offsetHeight):(this.startWidth=parseInt(this.element.clientWidth-
e),this.startHeight=parseInt(this.element.clientHeight-h));this.startMouseX=a.pageX;this.startMouseY=a.pageY;a=this.element.getBoundingClientRect();this.startTop=parseInt(a.top-g.y-b+window.pageYOffset);this.startLeft=parseInt(a.left-g.x-c+window.pageXOffset);if("w"==this.overBorder||"nw"==this.overBorder||"sw"==this.overBorder)this.rightIsZero="0px"==$ms.getPropertyValue(this.element,"right");this.startElementTop=$ms.getPropertyValue(this.element,"top");this.startElementLeft=$ms.getPropertyValue(this.element,
"left");this.startElementWidth=$ms.getPropertyValue(this.element,"width");this.startElementHeight=$ms.getPropertyValue(this.element,"height");this.settings.negativeSizeAllowed||("undefined"==typeof this.settings.minHeight&&(this.settings.minHeight=0),"undefined"==typeof this.settings.minWidth&&(this.settings.minWidth=0));"x"==this.lock?$ms.addClass(this.element,"ms-cursor-resize-ew"):"y"==this.lock?$ms.addClass(this.element,"ms-cursor-resize-ns"):"nw"==this.overBorder||"se"==this.overBorder?$ms.addClass(this.element,
"ms-cursor-resize-se"):("ne"==this.overBorder||"sw"==this.overBorder)&&$ms.addClass(this.element,"ms-cursor-resize-sw")};d.prototype.resizeElement=function(a){if(this.element&&!this.settings.disabled&&this.resizing)if(this.disabled)console.log("Resizing is disabled");else{this.diffX=parseInt(a.pageX-this.startMouseX);this.diffY=parseInt(a.pageY-this.startMouseY);a.altKey&&this.settings.altMirrors&&!this.settings.negativeSizeAllowed&&(this.mirror=!0,this.allow.top=!0,this.allow.left=!0);a.shiftKey||
this.settings.keepProportion?this.diffY=this.diffX=a=Math.abs(this.diffX)>Math.abs(this.diffY)?this.diffX:this.diffY:a.ctrlKey&&0==this.lock.length&&(this.lock=Math.abs(this.diffX)>Math.abs(this.diffY)?"x":"y");"x"==this.lock?this.diffY=0:"y"==this.lock&&(this.diffX=0);a="n"==this.overBorder||"nw"==this.overBorder||"ne"==this.overBorder?this.startHeight-this.diffY*(this.mirror?2:1):this.startHeight+this.diffY*(this.mirror?2:1);var c="w"==this.overBorder||"nw"==this.overBorder||"sw"==this.overBorder?
this.startWidth-this.diffX*(this.mirror?2:1):this.startWidth+this.diffX*(this.mirror?2:1),b=this.startTop,e=this.startLeft;"w"==this.overBorder||"nw"==this.overBorder||"sw"==this.overBorder?e=this.startLeft+this.diffX:this.mirror&&(e=this.startLeft-this.diffX);"n"==this.overBorder||"nw"==this.overBorder||"ne"==this.overBorder?b=this.startTop+this.diffY:this.mirror&&(b=this.startTop-this.diffY);this.settings.negativeSizeAllowed?(0>=c&&(e=this.startLeft+this.diffX),0>=a&&(b=this.startTop+this.diffY)):
(0>=a&&(a=0),a<=this.settings.minHeight&&(a=this.settings.minHeight,"n"==this.overBorder||"nw"==this.overBorder||"ne"==this.overBorder)&&(b=this.startHeight-this.settings.minHeight+this.startTop),0>=c&&(c=0),c<=this.settings.minWidth&&(c=this.settings.minWidth,"w"==this.overBorder||"nw"==this.overBorder||"sw"==this.overBorder)&&(e=this.startWidth-this.settings.minWidth+this.startLeft));this.allow.top&&b<this.settings.minTop||this.allow.left&&e<this.settings.minLeft||(this.allow.left&&!this.rightIsZero&&
(this.element.style.left=e+"px"),this.allow.top&&(this.mirror||"n"==this.overBorder||"nw"==this.overBorder||"ne"==this.overBorder||"bounding-box"==this.element.id)&&(this.element.style.top=b+"px"),c=Math.abs(c),a=Math.abs(a),this.settings.keepProportion&&(a=this.startHeight/this.startWidth*c),"y"!==this.lock&&this.allow.width&&(this.element.style.width=c+"px"),"x"!==this.lock&&this.allow.height&&(this.element.style.height=a+"px"),this.settings.alsoResize&&this.alsoResizeLinked(),this.settings.cbResize&&
(this.settings.cbClass?this.settings.cbResize.call(this.settings.cbClass,this.element,this):this.settings.cbResize(this.element,this)))}};d.prototype.alsoResizeLinked=function(){if(this.settings.alsoResize){var a=getComputedStyle(this.element).getPropertyValue("width"),c=getComputedStyle(this.element).getPropertyValue("height");Array.isArray(this.settings.alsoResize)||(this.settings.alsoResize=Array(this.settings.alsoResize));if(Array.isArray(this.settings.alsoResize))for(var b=0;b<this.settings.alsoResize.length;b++){var e=
this.allow.width&&"y"!==this.lock,h=this.allow.height&&"x"!==this.lock,g=!1;if($ms.hasClass(this.settings.alsoResize[b],"width100")||"100%"==this.settings.alsoResize[b].style.width||$ms.hasClass(this.settings.alsoResize[b],"width-auto")||"auto"==this.settings.alsoResize[b].style.width)g=!0;var k=!1;if($ms.hasClass(this.settings.alsoResize[b],"height100")||"100%"==this.settings.alsoResize[b].style.height||$ms.hasClass(this.settings.alsoResize[b],"height-auto")||"auto"==this.settings.alsoResize[b].style.height)k=
!0;"IMG"==this.settings.alsoResize[b].nodeName?(this.settings.alsoResize[b].width=parseFloat(a),this.settings.alsoResize[b].height=parseFloat(c)):(e&&!g&&(this.settings.alsoResize[b].style.width=a),h&&!k&&(this.settings.alsoResize[b].style.height=c),g=parseInt(getComputedStyle(this.settings.alsoResize[b]).getPropertyValue("width")),k=parseInt(getComputedStyle(this.settings.alsoResize[b]).getPropertyValue("height")),k>parseInt(c)&&h&&(this.element.style.height=k+"px",this.settings.alsoResize[b].style.height=
k+"px"),g>parseInt(a)&&e&&(this.element.style.width=g+"px",this.settings.alsoResize[b].style.width=g+"px"))}}};d.prototype.mirrorOff=function(){this.mirror&&(this.diffY=this.startTop-parseInt(this.element.style.top),this.diffX=this.startLeft-parseInt(this.element.style.left),this.element.style.top=this.startTop+"px",this.element.style.left=this.startLeft+"px",this.element.style.width=parseInt(this.element.style.width)-this.diffX+"px",this.element.style.height=parseInt(this.element.style.height)-this.diffY+
"px",this.settings.alsoResize&&this.alsoResizeLinked())};d.prototype.deleteElement=function(){"undefined"!==typeof this.element&&"bounding-box"==this.element.id&&"undefined"!==typeof this.element.parentNode&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)};d.prototype.hoverBorder=function(a){if(this.element&&!this.disabled){var c=$ms.innerSize(this.element),b="";this.allow.right&&parseInt(a.offsetX)>=parseInt(c.x-Math.max(6,c.ieBorder.x))?($ms.addClass(this.element,"ms-cursor-col-resize"),
$ms.removeClass(this.element,"ms-cursor-row-resize"),b="e"):this.allow.bottom&&parseInt(a.offsetY)>=parseInt(c.y-Math.max(6,c.ieBorder.y))?($ms.addClass(this.element,"ms-cursor-row-resize"),$ms.removeClass(this.element,"ms-cursor-col-resize"),b="s"):this.allow.left&&6>=a.offsetX?($ms.addClass(this.element,"ms-cursor-col-resize"),$ms.removeClass(this.element,"ms-cursor-row-resize"),b="w"):this.allow.top&&6>=a.offsetY?($ms.addClass(this.element,"ms-cursor-row-resize"),$ms.removeClass(this.element,"ms-cursor-col-resize"),
b="n"):($ms.removeClass(this.element,"ms-cursor-row-resize"),$ms.removeClass(this.element,"ms-cursor-col-resize"));return b}};d.prototype.setSettings=function(a){if("undefined"!=typeof a&&(this.settings=n,"undefined"!==typeof a))for(var c in a)a.hasOwnProperty(c)&&(this.settings[c]=a[c])};d.prototype.settings=function(a,c){if(this.settings.hasOwnProperty(a))return"undefined"!==typeof c&&(this.settings[a]=c),this.settings[a]};d.prototype.resizable=function(a,c){this.register(a,c)};d.prototype.register=
function(a,c){this.element=a;this.setSettings(c);this.createHandles();this.createHovers();this.settings.boundingBoxContainer&&this.createBoundingBox()};d.prototype.destroy=function(){this.close()};d.prototype.close=function(){for(var a=0;a<this.handleElements.length;a++)this.handleElements[a].removeEventListener("mousedown",this.handleMousedownListener),this.handleElements[a].parentNode.removeChild(this.handleElements[a]);this.handleElements=[];this.hoverMousemoveListener&&this.element.removeEventListener("mousemove",
this.hoverMousemoveListener);this.hoverMousedownListener&&this.element.addEventListener("mousedown",this.hoverMousedownListener);this.boundingBoxMousedownListener&&this.settings.boundingBoxContainer.removeEventListener("mousedown",this.boundingBoxMousedownListener)};d.prototype.enable=function(){this.settings.disabled=!1;for(var a=0;a<this.handleElements.length;a++)$ms.removeClass(this.handleElements[a],"display-none")};d.prototype.disable=function(){this.settings.disabled=!0;for(var a=0;a<this.handleElements.length;a++)$ms.addClass(this.handleElements[a],
"display-none")};d.prototype.createHandles=function(){if(""!==this.settings.handles&&this.element&&"static"!=this.element.style.position){Array.isArray(this.settings.handles)||(this.settings.handles=this.settings.handles.split(","));for(var a="n s e w se sw ne nw".split(" "),c=0;c<this.settings.handles.length;c++)if(-1!==a.indexOf(this.settings.handles[c])){switch(this.settings.handles[c]){case "n":this.allow.top=!0;this.allow.height=!0;break;case "s":this.allow.bottom=!0;this.allow.height=!0;break;
case "e":this.allow.right=!0;this.allow.width=!0;break;case "w":this.allow.left=!0;this.allow.width=!0;break;case "se":this.allow.bottom=!0;this.allow.right=!0;this.allow.height=!0;this.allow.width=!0;break;case "sw":this.allow.bottom=!0;this.allow.left=!0;this.allow.height=!0;this.allow.width=!0;break;case "ne":this.allow.top=!0;this.allow.right=!0;this.allow.height=!0;this.allow.width=!0;break;case "nw":this.allow.top=!0,this.allow.left=!0,this.allow.height=!0,this.allow.width=!0}var b=document.createElement("div"),
e="ms-handle ms-handle-"+this.settings.handles[c];2==this.settings.handles[c].length&&(e+="box"==this.settings.cornerHandles?"":"-triangle");this.settings.handleColor&&(e+=" "+e+"-"+this.settings.handleColor);this.settings.disabled&&(e+=" display-none");b.className=e;b.id=this.id+"handle-"+this.settings.handles[c];b.draggable=!1;this.handleMousedownListener=function(h){"left"===$ms.detectButton(h)&&this.mousedownHandle(h)}.bind(this);b.addEventListener("mousedown",this.handleMousedownListener,!1);
this.element.appendChild(b);this.handleElements.push(b)}}};d.prototype.createHovers=function(){var a=!1;if(""!==this.settings.hovers&&this.element){Array.isArray(this.settings.hovers)||(this.settings.hovers=this.settings.hovers.split(","));for(var c=["n","s","e","w"],b=0;b<this.settings.hovers.length;b++)if(-1!==c.indexOf(this.settings.hovers[b])){switch(this.settings.handles[b]){case "n":this.allow.top=!0;this.allow.height=!0;break;case "s":this.allow.bottom=!0;this.allow.height=!0;break;case "e":this.allow.right=
!0;this.allow.width=!0;break;case "w":this.allow.left=!0,this.allow.width=!0}a||(a=!0,this.hoverMousemoveListener=function(e){this.resizing||this.settings.disabled||(e.stopPropagation(),this.hoverBorder(e))}.bind(this),this.element.addEventListener("mousemove",this.hoverMousemoveListener,!1),this.hoverMousedownListener=function(e){this.resizing||this.settings.disabled||"left"===$ms.detectButton(e)&&this.mousedownHover(e)}.bind(this),this.element.addEventListener("mousedown",this.hoverMousedownListener,
!1))}}};d.prototype.mousedownHandle=function(a){if(a.target.classList.contains("ms-handle")&&!this.disabled){this.mousedownTarget=a.target;switch(a.target.id){case this.id+"handle-e":this.overBorder="e";this.lock="x";break;case this.id+"handle-w":this.overBorder="w";this.lock="x";break;case this.id+"handle-n":this.overBorder="n";this.lock="y";break;case this.id+"handle-s":this.overBorder="s";this.lock="y";break;case this.id+"handle-se":this.overBorder="se";this.lock="";break;case this.id+"handle-ne":this.overBorder=
"ne";this.lock="";break;case this.id+"handle-nw":this.overBorder="nw";this.lock="";break;case this.id+"handle-sw":this.overBorder="sw";this.lock="";break;default:return}this.mousedown(a)}};d.prototype.mousedownHover=function(a){if(!this.disabled){this.overBorder=this.hoverBorder(a);switch(this.overBorder){case "e":case "w":this.lock="x";break;case "n":case "s":this.lock="y";break;default:return}this.mousedown(a)}};d.prototype.createBoundingBox=function(){this.settings.boundingBoxContainer&&(this.allow=
{top:!0,left:!0,bottom:!0,right:!0,width:!0,height:!0},this.boundingBoxMousedownListener=function(a){"left"===$ms.detectButton(a)&&this.mousedown(a)}.bind(this),this.settings.boundingBoxContainer.addEventListener("mousedown",this.boundingBoxMousedownListener,!1))};d.prototype.mousedownBoundingBox=function(a){this.mousedown(a)};d.prototype.mousedown=function(a){this.disabled||(a.preventDefault(),this.resizing=!0,this.settings.cbStart&&(this.settings.cbClass?this.settings.cbStart.call(this.settings.cbClass,
this.element,this):this.settings.cbStart(this.element,this)),this.resizeMousemoveListener=function(c){this.resizeElement(c)}.bind(this),window.addEventListener("mousemove",this.resizeMousemoveListener),this.resizeMouseupListener=function(c){this.mouseup(c)}.bind(this),window.addEventListener("mouseup",this.resizeMouseupListener),this.init(a))};d.prototype.mouseup=function(a){this.disabled||(a.stopPropagation&&a.stopPropagation(),this.settings.cbStop&&(this.settings.cbClass?this.settings.cbStop.call(this.settings.cbClass,
this.element,this):this.settings.cbStop(this.element,this)),this.reset(),window.removeEventListener("mousemove",this.resizeMousemoveListener),window.removeEventListener("mouseup",this.resizeMouseupListener))};return d}();
